jQuery(document).ready(function(e){var t={check_notifications:function(){var o=t.web_root+"/ui/get_messages";"visible"===document.visibilityState&&e.getJSON(o,function(o){e.each(o,function(e,o){t.notify(o.type,o.title,o.message)})}),setTimeout(function(){"use strict";t.check_notifications()},3e3)},notify:function(e,t,o){var i={desktop:!0,icon:"images/ico/favicon-64.png"},n={dir1:"up",dir2:"left",firstpos1:25,firstpos2:25};PNotify.desktop.permission(),new PNotify({desktop:i,stack:n,addclass:"stack-bottomright",delay:5e3,hide:!0,history:!1,shadow:!1,styling:"jqueryui",width:"340px",type:e,title:t,text:o.replace(/<br[\s\/]*(?:\s[^>]*)?>/gi,"\n").replace(/<[\/]?b(?:\s[^>]*)?>/gi,"*").replace(/<i(?:\s[^>]*)?>/gi,"[").replace(/<[\/]i>/gi,"]").replace(/<(?:[\/]?ul|\/li)(?:\s[^>]*)?>/gi,"").replace(/<li(?:\s[^>]*)?>/gi,"\n* ")})},anon_url:function(e){return null===new URI(e).scheme&&(e="http://"+e),t.anonURL+e},isMeta:function(t,o){return new RegExp(o.length>1?o.join("|"):o).test(e('meta[data-var="'+t+'"]').data("content"))},getMeta:function(t){return e('meta[data-var="'+t+'"]').data("content")},metaToBool:function(t){var o=e('meta[data-var="'+t+'"]').data("content");return void 0===o?(console.log(t+" is empty, did you forget to add this to main.mako?"),o):!("false"===(o=isNaN(o)?o.toLowerCase():o.toString())||"none"===o||"0"===o)},common:{init:function(){t.srPID=t.getMeta("srPID"),t.srDefaultPage=t.getMeta("srDefaultPage"),t.themeSpinner=t.getMeta("themeSpinner"),t.web_root=t.getMeta("web_root"),t.loading='<img src="/images/loading16'+t.themeSpinner+'.gif" height="16" width="16" />',t.anonURL=t.getMeta("anonURL"),e.scrollUp({animation:"fade",scrollImg:{active:!0,type:"background",src:"images/top.png"}});for(var o=document.getElementsByTagName("img"),i=0;i<o.length;i++)o[i].getAttribute("data-src")&&o[i].setAttribute("src",o[i].getAttribute("data-src"));(navigator.maxTouchPoints||0)<2&&e(".dropdown-toggle").on("click",function(){"true"===e(this).attr("aria-expanded")&&(window.location.href=e(this).attr("href"))}),t.metaToBool("sickrage.FUZZY_DATING")&&(e.timeago.settings.allowFuture=!0,e.timeago.settings.strings={prefixAgo:null,prefixFromNow:"In ",suffixAgo:"ago",suffixFromNow:"",seconds:"less than a minute",minute:"about a minute",minutes:"%d minutes",hour:"an hour",hours:"%d hours",day:"a day",days:"%d days",month:"a month",months:"%d months",year:"a year",years:"%d years",wordSeparator:" ",numbers:[]},e("[datetime]").timeago()),e.tablesorter.addParser({id:"loadingNames",is:function(){return!1},format:function(e){return 0===e.indexOf("Loading...")?e.replace("Loading...","000"):t.metaToBool("sickrage.SORT_ARTICLE")?e||"":(e||"").replace(/^(The|A|An)\s/i,"")},type:"text"}),e.tablesorter.addParser({id:"quality",is:function(){return!1},format:function(e){return e.replace("hd1080p",5).replace("hd720p",4).replace("hd",3).replace("sd",2).replace("any",1).replace("best",0).replace("custom",7)},type:"numeric"}),e.tablesorter.addParser({id:"realISODate",is:function(){return!1},format:function(e){return new Date(e).getTime()},type:"numeric"}),e.tablesorter.addParser({id:"cDate",is:function(){return!1},format:function(e){return e},type:"numeric"}),e.tablesorter.addParser({id:"eps",is:function(){return!1},format:function(e){var o=e.match(/^(.*)/);if(null===o||"?"===o[1])return-10;var i=o[1].split(" / ");if(-1!==i[0].indexOf("+")){var n=i[0].split("+");i[0]=n[0]}if(i[0]=parseInt(i[0]),i[1]=parseInt(i[1]),0===i[0])return i[1];var r=parseInt(t.getMeta("max_download_count")*i[0]/i[1]),a=Math.round(i[0]/i[1]*100)/1e3;return r>0&&(r+=i[0]),r+a},type:"numeric"}),e.confirm.options={confirmButton:"Yes",cancelButton:"Cancel",dialogClass:"modal-dialog",post:!1,confirm:function(e){location.href=e.context.href}},e("a.shutdown").confirm({title:"Shutdown",text:"Are you sure you want to shutdown SiCKRAGE ?"}),e("a.restart").confirm({title:"Restart",text:"Are you sure you want to restart SiCKRAGE ?"}),e("a.clearhistory").confirm({title:"Clear History",text:"Are you sure you want to clear all download history ?"}),e("a.trimhistory").confirm({title:"Trim History",text:"Are you sure you want to trim all download history older than 30 days ?"}),e("a.submiterrors").confirm({title:"Submit Errors",text:'Are you sure you want to submit these errors ?<br><br><span class="red-text">Make sure SiCKRAGE is updated and trigger<br> this error with debug enabled before submitting</span>'}),e("a.removeshow").confirm({title:"Remove Show",text:'Are you sure you want to remove <span class="footerhighlight">'+e("#showtitle").data("showname")+'</span> from the database?<br><br><input type="checkbox" id="deleteFiles"> <span class="red-text">Check to delete files as well. IRREVERSIBLE</span></input>',confirm:function(t){location.href=t.context.href+(e("#deleteFiles")[0].checked?"&full=1":"")}}),e(".plotInfo").qtip({content:{attr:"data-tooltip"},position:{viewport:e(window),my:"left center",adjust:{y:-10,x:2}},style:{tip:{corner:!0,method:"polygon"},classes:"qtip-rounded qtip-shadow ui-tooltip-sb"}}),e(".title a").qtip({content:{attr:"data-tooltip"},show:{solo:!0},position:{viewport:e(window),my:"bottom center",at:"top center",adjust:{y:10,x:0}},style:{tip:{corner:!0,method:"polygon"},classes:"qtip-rounded qtip-shadow ui-tooltip-sb"}}),e(".imdbstars").qtip({content:{attr:"data-tooltip"},show:{solo:!0},position:{viewport:e(window),my:"right center",at:"center left",adjust:{y:0,x:-6}},style:{tip:{corner:!0,method:"polygon"},classes:"qtip-rounded qtip-shadow ui-tooltip-sb"}}),e("#removeW").click(function(){e("#white option:selected").remove().appendTo("#pool")}),e("#addW").click(function(){e("#pool option:selected").remove().appendTo("#white")}),e("#addB").click(function(){e("#pool option:selected").remove().appendTo("#black")}),e("#removeP").click(function(){e("#pool option:selected").remove()}),e("#removeB").click(function(){e("#black option:selected").remove().appendTo("#pool")}),e("#addToWhite").click(function(){var t=e("#addToPoolText").val();if(""!==t){var o=e("<option>");o.attr("value",t),o.html(t),o.appendTo("#white"),e("#addToPoolText").val("")}}),e("#addToBlack").click(function(){var t=e("#addToPoolText").val();if(""!==t){var o=e("<option>");o.attr("value",t),o.html(t),o.appendTo("#black"),e("#addToPoolText").val("")}}),e("#ui-components").tabs({activate:function(t,o){var i=e(this).data("lastOpenedPanel");i||(i=e(o.oldPanel)),e(this).data("topPositionTab")||e(this).data("topPositionTab",e(o.newPanel).position().top),e(o.newPanel).hide().fadeIn(0),i&&i.toggleClass("ui-tabs-hide").css("position","absolute").css("top",e(this).data("topPositionTab")+"px").fadeOut(0,function(){e(this).css("position","")}),e(this).data("lastOpenedPanel",e(o.newPanel))}}),t.browser.init(),t.root_dirs.init(),t.quality_chooser.init(),t.check_notifications()}},ajax_search:{searchStatusUrl:"/home/getManualSearchStatus",failedDownload:!1,qualityDownload:!1,selectedEpisode:"",manualSearches:[],init:function(){PNotify.prototype.options.maxonscreen=5,t.ajax_search.ajaxEpSearch({colorRow:!0}),t.ajax_search.checkManualSearches(),t.ajax_search.ajaxEpSubtitlesSearch()},enableLink:function(e){e.on("click.disabled",!1),e.prop("enableClick","1"),e.fadeTo("fast",1)},disableLink:function(e){e.off("click.disabled"),e.prop("enableClick","0"),e.fadeTo("fast",.5)},updateImages:function(o){e.each(o.episodes,function(o,i){var n="",r=e("a[id="+i.show+"x"+i.season+"x"+i.episode+"]"),a=r.children("img"),s=r.parent();if(r){var l="";"searching"===i.searchstatus.toLowerCase()?(a.prop("title","Searching"),a.prop("alt","Searching"),a.prop("src","/images/loading16.gif"),t.ajax_search.disableLink(r),n=i.searchstatus):"queued"===i.searchstatus.toLowerCase()?(a.prop("title","Queued"),a.prop("alt","queued"),a.prop("src","/images/queued.png"),t.ajax_search.disableLink(r),n=i.searchstatus):"finished"===i.searchstatus.toLowerCase()&&(a.prop("title","Searching"),a.prop("alt","searching"),a.parent().prop("class","epRetry"),a.prop("src","/images/search16.png"),t.ajax_search.enableLink(r),l=/(\w+)\s\((.+?)\)/,n=i.status.replace(l,'$1 <span class="quality '+i.quality+'">$2</span>'),s.closest("tr").prop("class",i.overview+" season-"+i.season+" seasonstyle")),s.siblings(".col-status").html(n)}var c=e("a[id=forceUpdate-"+i.show+"x"+i.season+"x"+i.episode+"]"),d=c.children("img");c&&("searching"===i.searchstatus.toLowerCase()?(d.prop("title","Searching"),d.prop("alt","Searching"),d.prop("src","/images/loading16.gif"),t.ajax_search.disableLink(c)):"queued"===i.searchstatus.toLowerCase()?(d.prop("title","Queued"),d.prop("alt","queued"),d.prop("src","/images/queued.png")):"finished"===i.searchstatus.toLowerCase()&&(d.prop("title","Manual Search"),d.prop("alt","[search]"),d.prop("src","/images/search16.png"),"snatched"===i.overview.toLowerCase()?c.closest("tr").remove():t.ajax_search.enableLink(c)))})},manualSearch:function(o){var i,n,r,a=t.ajax_search.selectedEpisode.parent(),s=t.ajax_search.selectedEpisode,l=t.ajax_search.selectedEpisode.children("img");l.prop("title","loading"),l.prop("alt",""),l.prop("src","/images/"+o.loadingImage);var c=t.ajax_search.selectedEpisode.prop("href");return!1===t.ajax_search.failedDownload&&(c=c.replace("retryEpisode","searchEpisode")),c=c+"&downCurQuality="+(t.ajax_search.qualityDownload?"1":"0"),e.getJSON(c,function(e){if("failure"===e.result.toLowerCase())i=o.noImage,n="failed";else{i=o.loadingImage,n="success",o.colorRow&&a.parent().removeClass("skipped wanted qual good unaired").addClass("snatched");r=e.result.replace(/(\w+)\s\((.+?)\)/,'$1 <span class="quality '+e.quality+'">$2</span>'),a.siblings(".col-status").html(r),t.ajax_search.disableLink(s)}l.prop("title",n),l.prop("alt",n),l.prop("height",o.size),l.prop("src","/images/"+i)}),!1},checkManualSearches:function(){var o=5e3,i=e("#showID").val(),n=void 0!==i?t.ajax_search.searchStatusUrl+"?show="+i:t.ajax_search.searchStatusUrl;e.ajax({url:n,success:function(e){o=e.episodes?5e3:15e3,t.ajax_search.updateImages(e)},error:function(){o=3e4},type:"GET",dataType:"json",complete:function(){setTimeout(t.ajax_search.checkManualSearches,o)},timeout:15e3})},ajaxEpSearch:function(o){var i={size:16,colorRow:!1,loadingImage:"loading16.gif",queuedImage:"queued.png",noImage:"no16.png",yesImage:"yes16.png"};o=e.extend({},i,o),e(".epRetry").click(function(o){if(o.preventDefault(),"0"===e(this).prop("enableClick"))return!1;t.ajax_search.selectedEpisode=e(this),e("#manualSearchModalFailed").modal("show")}),e(".epSearch").click(function(i){if(i.preventDefault(),"0"===e(this).prop("enableClick"))return!1;t.ajax_search.selectedEpisode=e(this),e(this).parent().parent().children(".col-status").children(".quality").length?e("#manualSearchModalQuality").modal("show"):t.ajax_search.manualSearch(o)}),e("#manualSearchModalFailed .btn").click(function(){t.ajax_search.failedDownload="yes"===e(this).text().toLowerCase(),e("#manualSearchModalQuality").modal("show")}),e("#manualSearchModalQuality .btn").click(function(){t.ajax_search.qualityDownload="yes"===e(this).text().toLowerCase(),t.ajax_search.manualSearch(o)})},ajaxEpSubtitlesSearch:function(){e(".epSubtitlesSearch").click(function(){var t=e(this).parent().siblings(".col-subtitles"),o=e(this);return o.empty(),o.append(e("<img/>").attr({src:"/images/loading16.gif",alt:"",title:"loading"})),e.getJSON(e(this).attr("href"),function(i){if("failure"!==i.result.toLowerCase()&&"no subtitles downloaded"!==i.result.toLowerCase()){var n=i.subtitles.split(",");t.empty(),e.each(n,function(o,i){""!==i&&"und"!==i&&(n.length,t.append(e("<img/>").attr({src:"/images/subtitles/flags/"+i+".png",alt:i,width:16,height:11})))}),o.remove()}else o.remove()}),!1})},ajaxEpMergeSubtitles:function(){e(".epMergeSubtitles").click(function(){var t=e(this);return t.empty(),t.append(e("<img/>").attr({src:"/images/loading16.gif",alt:"",title:"loading"})),e.getJSON(e(this).attr("href"),function(){t.remove()}),!1})}},browser:{defaults:{title:"Choose Directory",url:"/browser/",autocompleteURL:"/browser/complete",includeFiles:0,showBrowseButton:!0},fileBrowserDialog:null,currentBrowserPath:null,currentRequest:null,init:function(){e.fn.nFileBrowser=t.browser.nFileBrowser,e.fn.fileBrowser=t.browser.fileBrowser},browse:function(o,i,n){t.browser.currentBrowserPath!==o&&(t.browser.currentBrowserPath=o,t.browser.currentRequest&&t.browser.currentRequest.abort(),t.browser.fileBrowserDialog.dialog("option","dialogClass","browserDialog busy"),t.browser.currentRequest=e.getJSON(i,{path:o,includeFiles:n},function(o){t.browser.fileBrowserDialog.empty();var r,a=o[0],s=0,l=null;o=e.grep(o,function(){return 0!=s++}),e('<input type="text" class="form-control input-sm">').val(a.currentPath).on("keypress",function(e){13===e.which&&t.browser.browse(e.target.value,i,n)}).appendTo(t.browser.fileBrowserDialog).fileBrowser({showBrowseButton:!1}).on("autocompleteselect",function(e,o){t.browser.browse(o.item.value,i,n)}),r=e("<ul>").appendTo(t.browser.fileBrowserDialog),e.each(o,function(o,a){l=e('<a href="javascript:void(0)">').on("click",function(){a.isFile?(t.browser.currentBrowserPath=a.path,e('.browserDialog .ui-button:contains("Ok")').click()):t.browser.browse(a.path,i,n)}).text(a.name),a.isFile?l.prepend('<span class="ui-icon ui-icon-blank"></span>'):l.prepend('<span class="ui-icon ui-icon-folder-collapsed"></span>').on("mouseenter",function(){e("span",this).addClass("ui-icon-folder-open")}).on("mouseleave",function(){e("span",this).removeClass("ui-icon-folder-open")}),l.appendTo(r)}),e("a",r).wrap('<li class="ui-state-default ui-corner-all">'),t.browser.fileBrowserDialog.dialog("option","dialogClass","browserDialog")}))},nFileBrowser:function(o,i){i=e.extend({},t.browser.defaults,i),t.browser.fileBrowserDialog||(t.browser.fileBrowserDialog=e('<div id="fileBrowserDialog" style="display:hidden"></div>').appendTo("body").dialog({dialogClass:"browserDialog",title:i.title,position:["center",40],minWidth:Math.min(e(document).width()-80,650),height:Math.min(e(document).height()-80,e(window).height()-80),maxHeight:Math.min(e(document).height()-80,e(window).height()-80),maxWidth:e(document).width()-80,modal:!0,autoOpen:!1})),t.browser.fileBrowserDialog.dialog("option","buttons",[{text:"Ok",class:"btn",click:function(){o(t.browser.currentBrowserPath,i),e(this).dialog("close")}},{text:"Cancel",class:"btn",click:function(){e(this).dialog("close")}}]);var n="";return i.initialDir&&(n=i.initialDir),t.browser.browse(n,i.url,i.includeFiles),t.browser.fileBrowserDialog.dialog("open"),!1},fileBrowser:function(o){if(o=e.extend({},t.browser.defaults,o),o.field=e(this),o.field.autocomplete&&o.autocompleteURL){var i="";o.field.autocomplete({position:{my:"top",at:"bottom",collision:"flipfit"},source:function(t,n){i=e.ui.autocomplete.escapeRegex(t.term,o.includeFiles),e.ajax({url:o.autocompleteURL,data:t,dataType:"json",success:function(t){var o=new RegExp("^"+i,"i"),r=e.grep(t,function(e){return o.test(e)});n(r)}})},open:function(){e(".ui-autocomplete li.ui-menu-item a").removeClass("ui-corner-all"),e(".ui-autocomplete li.ui-menu-item:odd a").addClass("ui-menu-item-alternate")}}).data("ui-autocomplete")._renderItem=function(t,o){var n=o.label,r=new RegExp("(?![^&;]+;)(?!<[^<>]*)("+i+")(?![^<>]*>)(?![^&;]+;)","gi");return n=n.replace(r,function(e){return"<b>"+e+"</b>"}),e("<li></li>").data("ui-autocomplete-item",o).append("<a class='nowrap'>"+n+"</a>").appendTo(t)}}var n,r,a=!1;try{a=!!localStorage.getItem}catch(e){}return a&&o.key&&(n=localStorage["fileBrowser-"+o.key]),o.key&&0===o.field.val().length&&n&&o.field.val(n),r=function(e,t){t.field.val(e),a&&t.key&&(localStorage["fileBrowser-"+t.key]=e)},o.field.addClass("fileBrowserField"),o.showBrowseButton&&o.field.after(e('<input type="button" value="Browse&hellip;" class="btn btn-inline fileBrowser">').on("click",function(){var t=o.field.val()||o.key&&n||"",i=e.extend({},o,{initialDir:t});return e(this).nFileBrowser(r,i),!1})),o.field}},root_dirs:{init:function(){for(var o=["assert","clear","count","debug","dir","dirxml","error","exception","group","groupCollapsed","groupEnd","info","log","markTimeline","profile","profileEnd","table","time","timeEnd","timeStamp","trace","warn"],i=o.length,n=window.console=window.console||{};i--;){var r=o[i];n[r]||(n[r]=function(){})}e("#addRootDir").click(function(){e(this).nFileBrowser(t.root_dirs.addRootDir)}),e("#editRootDir").click(function(){e(this).nFileBrowser(t.root_dirs.editRootDir,{initialDir:e("#rootDirs option:selected").val()})}),e("#deleteRootDir").click(function(){if(e("#rootDirs option:selected").length){var o=e("#rootDirs option:selected"),i=o.attr("id")===e("#whichDefaultRootDir").val(),r=e("#rootDirs option:selected").attr("id").substr(3);if(o.remove(),t.root_dirs.syncOptionIDs(),i)n.log("new default when deleting"),e("#whichDefaultRootDir").val(""),e("#rootDirs option").length&&t.root_dirs.setDefault(e("#rootDirs option").attr("id"));else if(e("#whichDefaultRootDir").val().length){var a=e("#whichDefaultRootDir").val().substr(3);a>r&&e("#whichDefaultRootDir").val("rd-"+(a-1))}}t.root_dirs.refreshRootDirs(),e.get("/config/general/saveRootDirs",{rootDirString:e("#rootDirText").val()})}),e("#defaultRootDir").click(function(){e("#rootDirs option:selected").length&&t.root_dirs.setDefault(e("#rootDirs option:selected").attr("id")),t.root_dirs.refreshRootDirs(),e.get("/config/general/saveRootDirs",{rootDirString:e("#rootDirText").val()})}),e("#rootDirs").click(t.root_dirs.refreshRootDirs),t.root_dirs.syncOptionIDs(),t.root_dirs.setDefault(e("#whichDefaultRootDir").val(),!0),t.root_dirs.refreshRootDirs()},addRootDir:function(o){if(o.length){var i=!1;e("#whichDefaultRootDir").val().length||(i=!0),e("#rootDirs").append('<option value="'+o+'">'+o+"</option>"),t.root_dirs.syncOptionIDs(),i&&t.root_dirs.setDefault(e("#rootDirs option").attr("id")),t.root_dirs.refreshRootDirs(),e.get("/config/general/saveRootDirs",{rootDirString:e("#rootDirText").val()})}},editRootDir:function(o){o.length&&(e("#rootDirs option:selected").length&&(e("#rootDirs option:selected").attr("id")===e("#whichDefaultRootDir").val()?e("#rootDirs option:selected").text("*"+o):e("#rootDirs option:selected").text(o),e("#rootDirs option:selected").val(o)),t.root_dirs.refreshRootDirs(),e.get("/config/general/saveRootDirs",{rootDirString:e("#rootDirText").val()}))},setDefault:function(t,o){if(console.log("setting default to "+t),(void 0===t||t.length)&&(e("#whichDefaultRootDir").val()!==t||!0===o)){if("*"!==e("#"+t).text().charAt(0)&&e("#"+t).text("*"+e("#"+t).text()),e("#whichDefaultRootDir").val()&&!0!==o){var i=e("#"+e("#whichDefaultRootDir").val());i.text(i.text().substring(1))}e("#whichDefaultRootDir").val(t)}},syncOptionIDs:function(){var t=0;e("#rootDirs option").each(function(){e(this).attr("id","rd-"+t++)})},refreshRootDirs:function(){if(e("#rootDirs").length){var o="true";t.root_dirs.syncOptionIDs(),!e("#rootDirs option:selected").length&&e("#whichDefaultRootDir").val().length&&e("#"+e("#whichDefaultRootDir").val()).prop("selected",!0),e("#rootDirs option:selected").length&&(o=""),e("#deleteRootDir").prop("disabled",o),e("#defaultRootDir").prop("disabled",o),e("#editRootDir").prop("disabled",o);var i="",n="";e("#whichDefaultRootDir").val().length>=4&&(n=e("#whichDefaultRootDir").val().substr(3)),e("#rootDirs option").each(function(){i+=e(this).val()+"="+e(this).text()+"->"+e(this).attr("id")+"\n",n.length&&(n+="|"+e(this).val())}),i+="def: "+e("#whichDefaultRootDir").val(),console.log(i),e("#rootDirText").val(n),e("#rootDirText").change(),console.log("rootDirText: "+e("#rootDirText").val())}}},quality_chooser:{init:function(){e("#qualityPreset").change(function(){t.quality_chooser.setFromPresets(e("#qualityPreset :selected").val())}),t.quality_chooser.setFromPresets(e("#qualityPreset :selected").val())},setFromPresets:function(t){if(0===parseInt(t))return void e("#customQuality").show();e("#customQuality").hide(),e("#anyQualities option").each(function(){(t&e(this).val())>0?e(this).attr("selected","selected"):e(this).attr("selected",!1)}),e("#bestQualities option").each(function(){(t&e(this).val()<<16)>0?e(this).attr("selected","selected"):e(this).attr("selected",!1)})}},root:{init:function(){},schedule:function(){if(t.isMeta("sickrage.COMING_EPS_LAYOUT",["list"])){var o={date:0,show:2,network:5},i=t.getMeta("sickrage.COMING_EPS_SORT"),n=i in o?[[o[i],0]]:[[0,0]];e("#showListTable:has(tbody tr)").tablesorter({widgets:["stickyHeaders","filter","columnSelector","saveSort"],sortList:n,textExtraction:{0:function(t){return e(t).find("time").attr("datetime")},1:function(t){return e(t).find("time").attr("datetime")},7:function(t){return e(t).find("span").text().toLowerCase()}},headers:{0:{sorter:"realISODate"},1:{sorter:"realISODate"},2:{sorter:"loadingNames"},4:{sorter:"loadingNames"},7:{sorter:"quality"},8:{sorter:!1},9:{sorter:!1}},widgetOptions:function(){return t.metaToBool("sickrage.FILTER_ROW")?{filter_columnFilters:!0,filter_hideFilters:!0,filter_saveFilters:!0,columnSelector_mediaquery:!1}:{filter_columnFilters:!1,columnSelector_mediaquery:!1}}()}),t.ajax_search.ajaxEpSearch()}t.isMeta("sickrage.COMING_EPS_LAYOUT",["banner","poster"])&&(t.ajax_search.ajaxEpSearch({size:16,loadingImage:"loading16"+t.themeSpinner+".gif"}),e(".ep_summary").hide(),e(".ep_summaryTrigger").click(function(){e.next(".ep_summary").slideToggle("normal",function(){e.prev(".ep_summaryTrigger").attr("src",function(t,o){return e.next(".ep_summary").is(":visible")?o.replace("plus","minus"):o.replace("minus","plus")})})})),e("#popover").popover({placement:"bottom",html:!0,content:'<div id="popover-target"></div>'}).on("shown.bs.popover",function(){e.tablesorter.columnSelector.attachTo(e("#showListTable"),"#popover-target")})},history:function(){e("#historyTable:has(tbody tr)").tablesorter({widgets:["zebra","filter"],sortList:[[0,1]],textExtraction:function(){return t.isMeta("sickrage.HISTORY_LAYOUT",["detailed"])?{0:function(t){return e(t).find("time").attr("datetime")},4:function(t){return e(t).find("span").text().toLowerCase()}}:{0:function(t){return e(t).find("time").attr("datetime")},1:function(t){return e(t).find("span").text().toLowerCase()},2:function(t){return e(t).attr("data-provider").toLowerCase()},5:function(t){return e(t).attr("data-quality").toLowerCase()}}}(),headers:function(){return t.isMeta("sickrage.HISTORY_LAYOUT",["detailed"])?{0:{sorter:"realISODate"},4:{sorter:"data-quality"}}:{0:{sorter:"realISODate"},4:{sorter:!1},5:{sorter:"data-quality"}}}()}),e("#history_limit").on("change",function(){window.location.href="/history/?limit="+e(this).val()})},api_builder:function(){e("[data-action=api-call]").on("click",function(){var t=e("[data-command="+e(this).data("command-name")+"]"),o=e("#option-profile").is(":checked"),i=e(this).data("target"),n=e(this).data("time"),r=e("#"+e(this).data("base-url")).text(),a=e(this).data("url");e.each(t,function(t,o){var i=e(o).attr("name"),n=e(o).val();void 0!==i&&void 0!==n&&i!==n&&n&&(e.isArray(n)&&(n=n.join("|")),r+="&"+i+"="+n)}),o&&(r+="&profile=1");var s=(new Date).getTime();e.get(r,function(t,o,l){var c=(new Date).getTime()-s,d=e("#option-jsonp").is(":checked"),p=l.getResponseHeader("content-type")||"",h=e(i);if(e(n).text(c+"ms"),e(a).text(r+(d?"&jsonp=foo":"")),"image/"===p.slice(0,6))h.html(e("<img/>").attr("src",r));else{var u=JSON.stringify(t,null,4);d?h.text("foo("+u+");"):h.text(u)}h.parents(".result-wrapper").removeClass("hidden")})}),e("[data-action=clear-result]").on("click",function(){e(e(this).data("target")).html("").parents(".result-wrapper").addClass("hidden")}),e("[data-action=update-episodes]").on("change",function(){var t=e(this).data("command"),o=e("[data-command="+t+"][name=episode]"),i=e(this).val(),n=e("[data-command="+t+"][name=indexerid]").val(),r=o.val();if(void 0!==o){o.removeClass("hidden"),o.find("option:gt(0)").remove();for(var a in r[n][i])r[n][i].hasOwnProperty(a)&&o.append(e("<option>",{value:a,label:"Episode "+a}))}}),e("[data-action=update-seasons]").on("change",function(){var t=e(this).data("command"),o=e("[data-command="+t+"][name=season]"),i=e(this).val(),n=o.val();if(void 0!==o){o.removeClass("hidden"),o.find("option:gt(0)").remove();for(var r in n[i])n[i].hasOwnProperty(r)&&o.append(e("<option>",{value:r,label:0===r?"Specials":"Season "+r}))}}),e("#command-search").typeahead({source:t.getMeta("commands")}),e("#command-search").on("change",function(){var t=e(this).typeahead("getActive");if(t){var o=t.replace(".","-");e("[href=#command-"+o+"]").click()}})},status:function(){e("#schedulerStatusTable").tablesorter({widgets:["saveSort","zebra"]}),e("#queueStatusTable").tablesorter({widgets:["saveSort","zebra"],sortList:[[3,0],[4,0],[2,1]]})}},google:{init:function(){},login:function(){e.ajax({dataType:"json",url:"/google/get_user_code",type:"POST",success:function(o){var i="<center><h1>"+o.user_code+'</h1><br/>From any computer, please visit <a href="'+o.verification_url+'" target="_blank">'+o.verification_url+"</a> and enter the code</center>";e("#login-dialog").dialog({modal:!0,draggable:!1,width:"25%",title:"Link SiCKRAGE"}).html(i),t.google.poll_auth(o,(new Date).getTime()+1e3*new Date(o.user_code_expiry).getTime(),o.interval)}})},logout:function(){e.ajax({url:"/google/logout",success:function(){localStorage.clear(),location.reload()}})},poll_auth:function(o,i,n){(new Date).getTime()<i&&e.ajax({dataType:"json",url:"/google/get_credentials",data:{flow_info:JSON.stringify(o)},type:"POST",success:function(r){r.error?("slow_down"===r.error&&(n+=5),setTimeout(function(){t.google.poll_auth(o,i,n)},1e3*n)):(e("#login-dialog").dialog("close"),localStorage.setItem("google_refresh_token",r.refresh_token),localStorage.setItem("google_access_token",r.access_token),localStorage.setItem("google_token_type",r.token_type),location.reload())}})},refresh_auth:function(){e.ajax({dataType:"json",url:"/google/refresh_credentials",data:{token:localStorage.getItem("google_refresh_token")},type:"POST",success:function(e){localStorage.setItem("google_access_token",e.access_token),localStorage.setItem("google_token_type",e.token_type)},error:function(){t.google.logout()}})}},home:{init:function(){t.home.add_show_options(),t.root_dirs.init()},index:function(){e(".resetsorting").on("click",function(){e("table").trigger("filterReset")}),e(".progressbar").each(function(){var t=e(this).data("progress-percentage"),o=100===t?100:t>80?80:t>60?60:t>40?40:20;e(this).progressbar({value:t}),e(this).data("progress-text")&&e(this).append('<div class="progressbarText" title="'+e(this).data("progress-tip")+'">'+e(this).data("progress-text")+"</div>"),e(this).find(".ui-progressbar-value").addClass("progress-"+o)}),e("img#network").on("error",function(){e(this).parent().text(e(this).attr("alt")),e(this).remove()}),e("#showListTableShows:has(tbody tr), #showListTableAnime:has(tbody tr)").tablesorter({sortList:[[6,1],[2,0]],textExtraction:{0:function(t){return e(t).find("time").attr("datetime")},1:function(t){return e(t).find("time").attr("datetime")},3:function(t){return e(t).find("span").prop("title").toLowerCase()},4:function(t){return e(t).find("span").text().toLowerCase()},5:function(t){return e(t).find("span:first").text()},6:function(t){return e(t).find("img").attr("alt")}},widgets:["saveSort","zebra","stickyHeaders","filter","columnSelector"],headers:function(){return t.metaToBool("sickrage.FILTER_ROW")?{0:{sorter:"realISODate"},1:{sorter:"realISODate"},2:{sorter:"loadingNames"},4:{sorter:"quality"},5:{sorter:"eps"},6:{filter:"parsed"}}:{0:{sorter:"realISODate"},1:{sorter:"realISODate"},2:{sorter:"loadingNames"},4:{sorter:"quality"},5:{sorter:"eps"}}}(),widgetOptions:function(){return t.metaToBool("sickrage.FILTER_ROW")?{filter_columnFilters:!0,filter_hideFilters:!0,filter_functions:{5:function(e,t,o){var i=!1,n=Math.floor(t%1*1e3);if(""===o)i=!0;else{var r=o.match(/(<|<=|>=|>)\s(\d+)/i);r&&("<"===r[1]?n<parseInt(r[2])&&(i=!0):"<="===r[1]?n<=parseInt(r[2])&&(i=!0):">="===r[1]?n>=parseInt(r[2])&&(i=!0):">"===r[1]&&n>parseInt(r[2])&&(i=!0)),r=o.match(/(\d+)\s(-|to)\s(\d+)/i),r&&("-"!==r[2]&&"to"!==r[2]||n>=parseInt(r[1])&&n<=parseInt(r[3])&&(i=!0)),r=o.match(/(=)?\s?(\d+)\s?(=)?/i),r&&("="!==r[1]&&"="!==r[3]||parseInt(r[2])===n&&(i=!0)),!isNaN(parseFloat(o))&&isFinite(o)&&parseInt(o)===n&&(i=!0)}return i}},columnSelector_mediaquery:!1}:{filter_columnFilters:!1}}(),sortStable:!0,sortAppend:[[2,0]]}),e("#showListTableShows").find("tbody").find("tr").size()>0&&e.tablesorter.filter.bindSearch("#showListTableShows",e(".search")),t.metaToBool("sickrage.ANIME_SPLIT_HOME")&&e("#showListTableAnime").find("tbody").find("tr").size()>0&&e.tablesorter.filter.bindSearch("#showListTableAnime",e(".search"));var o=[e("#container"),e("#container-anime")];e.each(o,function(){e(this).isotope({itemSelector:".show",sortBy:t.getMeta("sickrage.POSTER_SORTBY"),sortAscending:t.getMeta("sickrage.POSTER_SORTDIR"),layoutMode:"masonry",masonry:{columnWidth:13,isFitWidth:!0},getSortData:{name:function(o){var i=e(o).attr("data-name");return t.metaToBool("sickrage.SORT_ARTICLE")?i||"":(i||"").replace(/^(The|A|An)\s/i,"")},network:"[data-network]",date:function(t){var o=e(t).attr("data-date");return o.length&&parseInt(o,10)||Number.POSITIVE_INFINITY},progress:function(t){var o=e(t).attr("data-progress");return o.length&&parseInt(o,10)||Number.NEGATIVE_INFINITY}}})}),e("#postersort").on("change",function(){var t=e(this).value;e("#container").isotope({sortBy:t}),e("#container-anime").isotope({sortBy:t}),e.get(e(this).options[e(this).selectedIndex].getAttribute("data-sort"))}),e("#postersortdirection").on("change",function(){var t=e(this).value;t="true"===t,e("#container").isotope({sortAscending:t}),e("#container-anime").isotope({sortAscending:t}),e.get(e(this).options[e(this).selectedIndex].getAttribute("data-sort"))}),e("#popover").popover({placement:"bottom",html:!0,content:'<div id="popover-target"></div>'}).on("shown.bs.popover",function(){e.tablesorter.columnSelector.attachTo(e("#showListTableShows"),"#popover-target"),t.metaToBool("sickrage.ANIME_SPLIT_HOME")&&e.tablesorter.columnSelector.attachTo(e("#showListTableAnime"),"#popover-target")})},display_show:{init:function(){t.home.display_show.imdb_stars(),t.ajax_search.init(),e("#seasonJump").on("change",function(){var t=e("#seasonJump option:selected").val();if(t&&"jump"!==t){var o=e("#seasonJump option:selected").data("season");e("html,body").animate({scrollTop:e('[name ="'+t.substring(1)+'"]').offset().top-50},"slow"),e("#collapseSeason-"+o).collapse("show"),location.hash=t}e(this).val("jump")}),e("#prevShow").on("click",function(){e("#pickShow option:selected").prev("option").prop("selected","selected"),e("#pickShow").change()}),e("#nextShow").on("click",function(){e("#pickShow option:selected").next("option").prop("selected","selected"),e("#pickShow").change()}),e("#changeStatus").on("click",function(){var t=[];if(e(".epCheck").each(function(){e(this).prop("checked")&&t.push(e(this).attr("id"))}),0===t.length)return!1;window.location.href="/home/setStatus?show="+e("#showID").attr("value")+"&eps="+t.join("|")+"&status="+e("#statusSelect").val()}),e("#deleteEpisode").on("click",function(){var t=[];if(e(".epCheck").each(function(){e(this).prop("checked")&&t.push(e(this).attr("id"))}),0===t.length)return!1;window.location.href="/home/deleteEpisode?show="+e("#showID").attr("value")+"&eps="+t.join("|")}),e(".seasonCheck").on("click",function(){var t=this,o=e(t).attr("id");e("#collapseSeason-"+o).collapse("show"),e(".epCheck:visible").each(function(){e(this).attr("id").split("x")[0]===o&&e(this).prop("checked",t.checked)})});var o=null;e(".epCheck").on("click",function(t){if(!o||!t.shiftKey)return void(o=this);var i=this,n=0;e(".epCheck").each(function(){switch(n){case 2:return!1;case 1:e(this).prop("checked",o.checked)}e(this)!==i&&e(this)!==o||n++})}),e(".seriesCheck").on("click",function(){e(".epCheck:visible").each(function(){e(this).prop("checked",!0)}),e(".seasonCheck:visible").each(function(){e(this).prop("checked",!0)})}),
e(".clearAll").on("click",function(){e(".epCheck:visible").each(function(){e(this).prop("checked",!1)}),e(".seasonCheck:visible").each(function(){e(this).prop("checked",!1)})}),e("#pickShow").on("change",function(){var t=e(this).val();0!==t&&(window.location.href="/home/displayShow?show="+t)}),e("#checkboxControls input").change(function(){var o=e(this).attr("id");t.home.display_show.showHideRows(o)}),e("#checkboxControls input").each(function(){var t=e(this).prop("checked");e("tr."+e(this).attr("id")).each(function(){t?e(this).show():e(this).hide()})}),e(".sceneSeasonXEpisode").on("change",function(){e(this).val(e(this).val().replace(/[^0-9xX]*/g,""));var o=e(this).attr("data-for-season"),i=e(this).attr("data-for-episode"),n=e(this).val().match(/^(\d+)x(\d+)$/i),r=null,a=null;n&&(r=n[1],a=n[2]),t.home.display_show.setEpisodeSceneNumbering(o,i,r,a)}),e(".sceneAbsolute").on("change",function(){e(this).val(e(this).val().replace(/[^0-9xX]*/g,""));var o=e(this).attr("data-for-absolute"),i=e(this).val().match(/^(\d{1,3})$/i),n=null;i&&(n=i[1]),t.home.display_show.setAbsoluteSceneNumbering(o,n)}),e(".addQTip").each(function(){e(this).css({cursor:"help","text-shadow":"0px 0px 0.5px #666"}),e(this).qtip({show:{solo:!0},position:{viewport:e(window),my:"left center",adjust:{y:-10,x:2}},style:{tip:{corner:!0,method:"polygon"},classes:"qtip-rounded qtip-shadow ui-tooltip-sb"}})}),e("#showTable, #animeTable").tablesorter({widgets:["saveSort","stickyHeaders","columnSelector"],widgetOptions:{columnSelector_saveColumns:!0,columnSelector_layout:'<br><label><input type="checkbox">{name}</label>',columnSelector_mediaquery:!1,columnSelector_cssChecked:"checked"}}),e("#popover").popover({placement:"bottom",html:!0,content:'<div id="popover-target"></div>'}).on("shown.bs.popover",function(){e.tablesorter.columnSelector.attachTo(e("#showTable, #animeTable"),"#popover-target")})},showHideRows:function(t){var o=e("#checkboxControls > input, #"+t).prop("checked");e("tr."+t).each(function(){o?e(this).show():e(this).hide()}),e("tr.seasonheader").each(function(){var t=0,o=e(this).attr("id");e("tr."+o+" :visible").each(function(){t++}),0===t?(e(this).hide(),e("#"+o+"-cols").hide()):(e(this).show(),e("#"+o+"-cols").show())})},setEpisodeSceneNumbering:function(t,o,i,n){var r=e("#showID").val(),a=e("#indexer").val();""===i&&(i=null),""===n&&(n=null),e.getJSON("/home/setSceneNumbering",{show:r,indexer:a,forSeason:t,forEpisode:o,sceneSeason:i,sceneEpisode:n},function(i){null===i.sceneSeason||null===i.sceneEpisode?e("#sceneSeasonXEpisode_"+r+"_"+t+"_"+o).val(""):e("#sceneSeasonXEpisode_"+r+"_"+t+"_"+o).val(i.sceneSeason+"x"+i.sceneEpisode),i.success||(i.errorMessage?alert(i.errorMessage):alert("Update failed."))})},setAbsoluteSceneNumbering:function(t,o){var i=e("#showID").val(),n=e("#indexer").val();""===o&&(o=null),e.getJSON("/home/setSceneNumbering",{show:i,indexer:n,forAbsolute:t,sceneAbsolute:o},function(o){null===o.sceneAbsolute?e("#sceneAbsolute_"+i+"_"+t).val(""):e("#sceneAbsolute_"+i+"_"+t).val(o.sceneAbsolute),o.success||(o.errorMessage?alert(o.errorMessage):alert("Update failed."))})},imdb_stars:function(){return e(".imdbstars").each(function(t,o){e(o).html(e("<span/>").width(12*e(o).text()))})}},edit_show:{init:function(){var o=[];e("#location").fileBrowser({title:"Select Show Location"}),e("#submit").click(function(){var o=[];e("#exceptions_list option").each(function(){o.push(e(this).val())}),e("#exceptions_list").val(o),t.metaToBool("show.is_anime")&&t.generate_bwlist()}),e("#addSceneName").click(function(){var t=e("#SceneName").val(),i=e("<option>");if(o=[],e("#exceptions_list option").each(function(){o.push(e(this).val())}),e("#SceneName").val(""),!(e.inArray(t,o)>-1||""===t))return e("#SceneException").show(),i.attr("value",t),i.html(t),i.appendTo("#exceptions_list")}),e("#removeSceneName").click(function(){e("#exceptions_list option:selected").remove(),t.home.edit_show.toggleSceneException()}),t.home.edit_show.toggleSceneException()},toggleSceneException:function(){var t=[];e("#exceptions_list option").each(function(){t.push(e(this).val())}),""===t?e("#SceneException").hide():e("#SceneException").show()}},add_existing_shows:{init:function(){e("#tabs").tabs({collapsible:!0,selected:t.metaToBool("sickrage.SORT_ARTICLE")?-1:0}),e("#tableDiv").on("click","#checkAll",function(){e(".dirCheck").not(this).prop("checked",this.checked)}),e("#submitShowDirs").on("click",function(){var t=[];if(e(".dirCheck").each(function(){if(e(this).prop("checked")){var o=e(this).attr("id"),i=e(this).closest("tr").find("select").val();t.push(encodeURIComponent(i+"|"+o))}}),0===t.length)return!1;var o="/home/addShows/addExistingShows?promptForSettings="+(e("#promptForSettings").prop("checked")?"on":"off")+"&shows_to_add="+t.join("&shows_to_add=");o.length<2083?window.location.href=o:alert("You've selected too many shows, please uncheck some and try again. ["+o.length+"/2083 characters]")});var o="";e("#rootDirText").on("change",function(){if(o===e("#rootDirText").val())return!1;o=e("#rootDirText").val(),e("#rootDirStaticList").html(""),e("#rootDirs option").each(function(t,o){e("#rootDirStaticList").append('<li class="ui-state-default ui-corner-all"><input type="checkbox" class="cb dir_check" id="'+e(o).val()+'" checked=checked> <label for="'+e(o).val()+'"><b>'+e(o).val()+"</b></label></li>")}),t.home.add_existing_shows.loadContent()}),e("#rootDirStaticList").on("click",".dir_check",t.home.add_existing_shows.loadContent),e("#tableDiv").on("click",".showManage",function(t){t.preventDefault(),e("#tabs").tabs("option","active",0),e("html,body").animate({scrollTop:0},1e3)}),e("#rootDirs option").attr("selected","selected").parent().focus(),e("#rootDirs option").click()},loadContent:function(){var o="";e(".dir_check").each(function(t,i){e(i).is(":checked")&&(o.length&&(o+="&"),o+="rootDir="+encodeURIComponent(e(i).attr("id")))}),e("#tableDiv").html('<img id="searchingAnim" src="'+t.getMeta("web_root")+'/images/loading32.gif" height="32" width="32" /> loading folders...'),e.get(t.web_root+"/home/addShows/massAddTable/",o,function(t){e("#tableDiv").html(t),e("#addRootDirTable").tablesorter({sortList:[[1,0]],widgets:["zebra"],headers:{0:{sorter:!1}}})})}},postprocess:function(){e("#episodeDir").fileBrowser({title:"Select Unprocessed Episode Folder",key:"postprocessPath"})},trending_shows:{init:function(){e("#showsort").val("original"),e("#showsortdirection").val("asc");var o=[e("#container")];e.each(o,function(){e(this).isotope({itemSelector:".trakt_show",sortBy:"original-order",layoutMode:"fitRows",getSortData:{name:function(o){var i=e(o).attr("data-name")||"";return(t.metaToBool("sickrage.SORT_ARTICLE")?i:i.replace(/^(The|A|An)\s/i,"")).toLowerCase()},rating:"[data-rating] parseInt",votes:"[data-votes] parseInt"}})}),e("#showsort").on("change",function(){var t;switch(e(this).value){case"original":t="original-order";break;case"rating":e("#container").isotope({sortBy:"random"}),t="rating";break;case"rating_votes":t=["rating","votes"];break;case"votes":t="votes";break;default:t="name"}e("#container").isotope({sortBy:t})}),e("#showsortdirection").on("change",function(){e("#container").isotope({sortAscending:"asc"===e(this).value})}),e("#trendingShows").loadContent("/home/addShows/getTrendingShows/","Loading trending shows...","Trakt timed out, refresh page to try again"),e("#container").isotope({itemSelector:".trakt_show",layoutMode:"fitRows"})},loadContent:function(o,i,n){e(this).html('<img id="searchingAnim" src="'+t.web_root+"/images/loading32"+t.themeSpinner+'.gif" height="32" width="32" />&nbsp;'+i),e(this).load(o+" #container",function(t,o){"error"===o&&e(this).empty().html(n)})}},recommended_shows:{init:function(){e("#tabs").tabs({collapsible:!0,selected:t.metaToBool("sickrage.SORT_ARTICLE")?-1:0}),e("#showsort").val("original"),e("#showsortdirection").val("asc");var o=[e("#container")];e.each(o,function(){e(this).isotope({itemSelector:".trakt_show",sortBy:"original-order",layoutMode:"fitRows",getSortData:{name:function(o){var i=e(o).attr("data-name");return t.metaToBool("sickrage.SORT_ARTICLE")?i||"":(i||"").replace(/^(The|A|An)\s/i,"")},rating:"[data-rating] parseInt",votes:"[data-votes] parseInt"}})}),e("#showsort").on("change",function(){var t;switch(e(this).value){case"original":t="original-order";break;case"rating":e("#container").isotope({sortBy:"random"}),t="rating";break;case"rating_votes":t=["rating","votes"];break;case"votes":t="votes";break;default:t="name"}e("#container").isotope({sortBy:t})}),e("#showsortdirection").on("change",function(){e("#container").isotope({sortAscending:"asc"===e(this).value})}),e("#recommendedShows").loadContent("/home/addShows/getRecommendedShows/","Loading recommended shows...","Trakt timed out, refresh page to try again"),e("#container").isotope({itemSelector:".trakt_show",layoutMode:"fitRows"})},loadContent:function(o,i,n){e(this).html('<img id="searchingAnim" src="'+t.web_root+"/images/loading32"+t.themeSpinner+'.gif" height="32" width="32" />&nbsp;'+i),e(this).load(o+" #container",function(t,o){"error"===o&&e(this).empty().html(n)})}},popular_shows:function(){e("#popularShows:has(tbody tr)").tablesorter({sortList:[[2,1]]})},test_renaming:function(){e(".seriesCheck").on("click",function(){var t=this;e(".seasonCheck:visible").each(function(){e(this).prop("checked",t.checked)}),e(".epCheck:visible").each(function(){e(this).prop("checked",t.checked)})}),e(".seasonCheck").click(function(){var t=this,o=e(t).attr("id");e(".epCheck:visible").each(function(){e(this).attr("id").split("x")[0]===o&&e(this).prop("checked",t.checked)})}),e("input[type=submit]").on("click",function(){var t=[];if(e(".epCheck").each(function(){e(this).prop("checked")&&t.push(e(this).attr("id"))}),0===t.length)return!1;window.location.href="/home/doRename?show="+e("#showID").attr("value")+"&eps="+t.join("|")})},restart:function(){var o=setInterval(function(){e.ajax({url:"/home/is_alive/",dataType:"jsonp",jsonp:"srcallback",success:function(i){""!==t.srPID&&i.msg!==t.srPID||(e("#shut_down_loading").hide(),e("#shut_down_success").show(),clearInterval(o),e("#restart_loading").hide(),e("#restart_success").show(),setTimeout(function(){e("#refresh_message").show(),window.location="/"+t.srDefaultPage+"/"},25e3))},error:function(t){e("#restart_message").show()}})},100)},new_show:{init:function(){e("#addShowForm").steps({bodyTag:"section",transitionEffect:"fade",stepsOrientation:"vertical",onStepChanging:function(o,i,n){var r;return i>n||(t.home.add_show_options(),t.root_dirs.init(),t.quality_chooser.init(),r=e("input:radio[name=whichSeries]:checked").length?e("input:radio[name=whichSeries]:checked").val().split("|")[4]:e("input:hidden[name=whichSeries]").length&&e("input:hidden[name=whichSeries]").val().length?e("#providedName").val():"",r.length?(t.home.update_bwlist(r),!0):void 0)},onFinished:function(o,i){t.home.generate_bwlist(),e(this).submit()}}),e("input:hidden[name=whichSeries]").length&&e("#fullShowPath").length&&e("#addShowForm").steps("getStep","1"),e("#searchName").on("click",function(){e("#searchName").prop("disabled",!0),t.home.new_show.searchIndexers(),e("#searchName").prop("disabled",!1)}),e("#skipShowButton").on("click",function(){e("#skipShow").val("1"),e("#addShowForm").submit()}),e("#nameToSearch").focus(),e("#indexerLang").bfhlanguages({language:t.getMeta("sickrage.DEFAULT_LANGUAGE"),available:t.getMeta("sickrage.LANGUAGES")})},searchIndexers:function(){if(e("#nameToSearch").val().length){var o="<b>"+e("#nameToSearch").val().trim()+"</b> on "+e("#providedIndexer option:selected").text()+"<br/>";e("#messages").empty().html('<img id="searchingAnim" src="'+t.web_root+"/images/loading32"+t.themeSpinner+'.gif" height="24" width="24" /> searching for '+o),e.ajax({url:"/home/addShows/searchIndexersForShowName",data:{search_term:e("#nameToSearch").val().trim(),lang:e("#indexerLang").val(),indexer:e("#providedIndexer").val()},timeout:1e3*parseInt(e("#indexer_timeout").val(),10),dataType:"json",error:function(){e("#messages").empty().html("search timed out, try increasing timeout for indexer")},success:function(o){var i=!0,n='<legend class="legend">Search Results:</legend>\n',r="";0===o.results.length?n+="<b>No results found, try a different search or language.</b>":(e.each(o.results,function(e,a){i?(r=" checked",i=!1):r="";var s=a.join("|");if(n+='<input type="radio" class="pull-left" id="whichSeries" name="whichSeries" value="'+s.replace(/"/g,"")+'"'+r+" /> ",n+='<a href="'+t.anon_url(a[2]+a[3]+"&lid="+o.langid||7)+'" onclick="window.open(this.href, \'_blank\'); return false;" ><b>'+a[4]+"</b></a>",null!==a[5]){var l=new Date(a[5]),c=new Date;n+=l>c?" (will debut on "+a[5]+")":" (started on "+a[5]+")"}null!==a[0]&&(n+=" ["+a[0]+"]"),n+="<br/>"}),n+="</ul>"),n+="<br/>",e("#messages").html(n)}})}}},add_show_options:function(){e("#saveDefaultsButton").on("click",function(){var t=[],o=[];e("#anyQualities option:selected").each(function(o,i){t.push(e(i).val())}),e("#bestQualities option:selected").each(function(t,i){o.push(e(i).val())}),e.get("/config/general/saveAddShowDefaults",{defaultStatus:e("#statusSelect").val(),anyQualities:t.join(","),bestQualities:o.join(","),defaultFlattenFolders:e("#flatten_folders").prop("checked"),subtitles:e("#subtitles").prop("checked"),anime:e("#anime").prop("checked"),scene:e("#scene").prop("checked"),defaultStatusAfter:e("#statusSelectAfter").val(),archive:e("#archive").prop("checked")}),e(this).attr("disabled",!0),new PNotify({title:"Saved Defaults",text:'Your "add show" defaults have been set to your current selections.',shadow:!1})}),e("#statusSelect, #qualityPreset, #flatten_folders, #anyQualities, #bestQualities, #subtitles, #scene, #anime, #statusSelectAfter, #archive").change(function(){e("#saveDefaultsButton").attr("disabled",!1)})},generate_bwlist:function(){var t=[];e("#white option").each(function(o,i){t[o]=e(i).val()}),e("#whitelist").val(t.join(",")),t=[],e("#black option").each(function(o,i){t[o]=e(i).val()}),e("#blacklist").val(t.join(","))},update_bwlist:function(t){e("#white").children().remove(),e("#black").children().remove(),e("#pool").children().remove(),e("#anime").prop("checked")?(e("#blackwhitelist").show(),t&&e.getJSON("/home/fetch_releasegroups",{show_name:t},function(t){"success"===t.result&&e.each(t.groups,function(t,o){var i=e("<option>");i.attr("value",o.name),i.html(o.name+" | "+o.rating+" | "+o.range),i.appendTo("#pool")})})):e("#blackwhitelist").hide()}},config:{init:function(){e("#configForm").ajaxForm({beforeSubmit:function(){e(".config_submitter .config_submitter_refresh").each(function(){e(this).attr("disabled","disabled"),e(this).after("<span>"+t.loading+" Saving...</span>"),e(this).hide()})},success:function(){setTimeout(function(){"use strict";e(".config_submitter").each(function(){e(this).removeAttr("disabled"),e.next().remove(),e(this).show()}),e(".config_submitter_refresh").each(function(){e(this).removeAttr("disabled"),e.next().remove(),e(this).show(),window.location.reload()}),e("#email_show").trigger("notify")},2e3)}})},general:function(){0===e("input[name='proxy_setting']").val().length&&(e("input[id='proxy_indexers']").prop("checked",!1),e("label[for='proxy_indexers']").hide()),e("input[name='proxy_setting']").on("input",function(){0===e(this).val().length?(e("input[id='proxy_indexers']").prop("checked",!1),e("label[for='proxy_indexers']").hide()):e("label[for='proxy_indexers']").show()}),e(".enabler").each(function(){e(this).prop("checked")||e("#content_"+e(this).attr("id")).hide()}),e(".enabler").on("click",function(){e(this).prop("checked")?e("#content_"+e(this).attr("id")).fadeIn("fast","linear"):e("#content_"+e(this).attr("id")).fadeOut("fast","linear")}),e(".viewIf").on("click",function(){e(this).prop("checked")?(e(".hide_if_"+e(this).attr("id")).css("display","none"),e(".show_if_"+e(this).attr("id")).fadeIn("fast","linear")):(e(".show_if_"+e(this).attr("id")).css("display","none"),e(".hide_if_"+e(this).attr("id")).fadeIn("fast","linear"))}),e(".datePresets").on("click",function(){var t=e("#date_presets").val();e(this).prop("checked")&&"%x"===t?(t="%a, %b %d, %Y",e("#date_use_system_default").html("1")):e(this).prop("checked")||"1"!==e("#date_use_system_default").html()||(t="%x"),e("#date_presets").attr("name","date_preset_old"),e("#date_presets").attr("id","date_presets_old"),e("#date_presets_na").attr("name","date_preset"),e("#date_presets_na").attr("id","date_presets"),e("#date_presets_old").attr("name","date_preset_na"),e("#date_presets_old").attr("id","date_presets_na"),t&&e("#date_presets").val(t)}),e("#api_key").on("click",function(){e("#api_key").select()}),e("#generate_new_apikey").on("click",function(){e.get("/config/general/generateApiKey",function(t){if(void 0!==t.error)return void alert(t.error);e("#api_key").val(t)})}),e("#branchCheckout").on("click",function(){window.location.href="/home/branchCheckout?branch="+e("#branchVersion").val()}),e("#google_link").on("click",function(){null===localStorage.getItem("google_token_type")||null===localStorage.getItem("google_access_token")?t.google.login():t.google.logout()}),null===localStorage.getItem("google_token_type")||null===localStorage.getItem("google_access_token")?e("#google_link").prop("value","Link"):e("#google_link").prop("value","Unlink")},subtitles:{init:function(){e("#subtitles_dir").fileBrowser({title:"Select Subtitles Download Directory"}),e("#editAService").change(function(){t.config.subtitles.showHideServices()}),e(".service_enabler").on("click",function(){t.config.subtitles.refreshServiceList()}),t.config.subtitles.showHideServices(),e("#service_order_list").sortable({placeholder:"ui-state-highlight",update:function(){t.config.subtitles.refreshServiceList()}}),e("#service_order_list").disableSelection()},showHideServices:function(){e(".serviceDiv").each(function(){var t=e(this).attr("id");e("#editAService :selected").val()+"Div"===t?e(this).show():e(this).hide()})},addService:function(o,i,n,r,a,s){if(null===n.match("/$")&&(n+="/"),0===e("#service_order_list > #"+o).length&&!1!==s){var l='<li class="ui-state-default" id="'+o+'"> <input type="checkbox" id="enable_'+o+'" class="service_enabler" CHECKED> <a href="'+t.anon_url(n)+'" class="imgLink" target="_new"><img src="/images/services/newznab.gif" alt="'+i+'" width="16" height="16"></a> '+i+"</li>";e("#service_order_list").append(l),e("#service_order_list").sortable("refresh")}},deleteService:function(t){e("#service_order_list > #"+t).remove()},refreshServiceList:function(){var t=e("#service_order_list").sortable("toArray"),o=[];e.each(t,function(t,i){var n=+e("#enable_"+i).prop("checked")?"1":"0";o.push(i+":"+n)}),e("#service_order").val(o.join(" "))}},search:{init:function(){e("#nzb_method").change(t.config.search.nzbMethodHandler),e("#torrent_method").change(t.config.search.torrentMethodHandler),t.config.search.nzbMethodHandler(),t.config.search.torrentMethodHandler(),e("#testSABnzbd").click(function(){e("#testSABnzbd_result").html(t.loading);var o=e("#sab_host").val(),i=e("#sab_username").val(),n=e("#sab_password").val(),r=e("#sab_apikey").val();e.get("/home/testSABnzbd",{host:o,username:i,password:n,apikey:r},function(t){e("#testSABnzbd_result").html(t)})}),e("#use_torrents").click(function(){t.config.search.toggleTorrentTitle()}),e("#test_torrent").click(function(){e("#test_torrent_result").html(t.loading);var o=e("#torrent_method :selected").val(),i=e("#torrent_host").val(),n=e("#torrent_username").val(),r=e("#torrent_password").val();e.get("/home/testTorrent",{torrent_method:o,host:i,username:n,password:r},function(t){e("#test_torrent_result").html(t)})}),e("#torrent_host").change(t.config.search.rtorrentScgi),e("#nzb_dir").fileBrowser({title:"Select .nzb blackhole/watch location"}),e("#torrent_dir").fileBrowser({title:"Select .torrent blackhole/watch location"}),e("#torrent_path").fileBrowser({title:"Select .torrent download location"})},toggleTorrentTitle:function(){e("#use_torrents").prop("checked")?e("#no_torrents").show():e("#no_torrents").hide()},nzbMethodHandler:function(){e("#blackhole_settings").hide(),e("#sabnzbd_settings").hide(),e("#testSABnzbd").hide(),e("#testSABnzbd_result").hide(),e("#nzbget_settings").hide(),"blackhole"===e("#nzb_method").val().toLowerCase()?e("#blackhole_settings").show():"nzbget"===e("#nzb_method").val().toLowerCase()?e("#nzbget_settings").show():(e("#sabnzbd_settings").show(),e("#testSABnzbd").show(),e("#testSABnzbd_result").show())},torrentMethodHandler:function(){e("#options_torrent_clients").hide(),e("#options_torrent_blackhole").hide();var t=e("#torrent_method").val(),o="",i="#options_torrent_blackhole";e("#torrent_method_icon").removeClass(function(e,t){return(t.match(/(^|\s)add-client-icon-\S+/g)||[]).join(" ")}),e("#torrent_method_icon").addClass("add-client-icon-"+t.replace("_","-")),"blackhole"!==t.toLowerCase()&&(e("#label_warning_deluge").hide(),e("#label_anime_warning_deluge").hide(),e("#host_desc_torrent").show(),e("#torrent_verify_cert_option").hide(),e("#torrent_verify_deluge").hide(),e("#torrent_verify_rtorrent").hide(),e("#torrent_auth_type_option").hide(),e("#torrent_path_option").show(),e("#torrent_path_option").find(".fileBrowser").show(),e("#torrent_seed_time_option").hide(),e("#torrent_high_bandwidth_option").hide(),e("#torrent_label_option").show(),e("#torrent_label_anime_option").show(),e("#path_synology").hide(),e("#torrent_paused_option").show(),e("#torrent_rpcurl_option").hide(),"utorrent"===t.toLowerCase()?(o="uTorrent",e("#torrent_path_option").hide(),e("#torrent_seed_time_label").text("Minimum seeding time is"),e("#torrent_seed_time_option").show(),e("#host_desc_torrent").text("URL to your uTorrent client (e.g. http://localhost:8000)")):"transmission"===t.toLowerCase()?(o="Transmission",e("#torrent_seed_time_label").text("Stop seeding when inactive for"),e("#torrent_seed_time_option").show(),e("#torrent_high_bandwidth_option").show(),e("#torrent_label_option").hide(),e("#torrent_label_anime_option").hide(),e("#torrent_rpcurl_option").show(),e("#host_desc_torrent").text("URL to your Transmission client (e.g. http://localhost:9091)")):"deluge"===t.toLowerCase()?(o="Deluge",e("#torrent_verify_cert_option").show(),e("#torrent_verify_deluge").show(),e("#torrent_verify_rtorrent").hide(),e("#label_warning_deluge").show(),e("#label_anime_warning_deluge").show(),e("#torrent_username_option").hide(),e("#torrent_username").prop("value",""),e("#host_desc_torrent").text("URL to your Deluge client (e.g. http://localhost:8112)")):"deluged"===t.toLowerCase()?(o="Deluge",e("#torrent_verify_cert_option").hide(),e("#torrent_verify_deluge").hide(),e("#torrent_verify_rtorrent").hide(),e("#label_warning_deluge").show(),e("#label_anime_warning_deluge").show(),e("#torrent_username_option").show(),e("#host_desc_torrent").text("IP or Hostname of your Deluge Daemon (e.g. scgi://localhost:58846)")):"download_station"===t.toLowerCase()?(o="Synology DS",e("#torrent_label_option").hide(),e("#torrent_label_anime_option").hide(),e("#torrent_paused_option").hide(),e("#torrent_path_option").find(".fileBrowser").hide(),e("#host_desc_torrent").text("URL to your Synology DS client (e.g. http://localhost:5000)"),e("#path_synology").show()):"rtorrent"===t.toLowerCase()?(o="rTorrent",e("#torrent_paused_option").hide(),e("#host_desc_torrent").text("URL to your rTorrent client (e.g. scgi://localhost:5000 <br> or https://localhost/rutorrent/plugins/httprpc/action.php)"),e("#torrent_verify_cert_option").show(),e("#torrent_verify_deluge").hide(),e("#torrent_verify_rtorrent").show(),e("#torrent_auth_type_option").show()):"qbittorrent"===t.toLowerCase()?(o="qbittorrent",e("#torrent_path_option").hide(),e("#label_warning_qbittorrent").show(),e("#label_anime_warning_qbittorrent").show(),e("#host_desc_torrent").text("URL to your qbittorrent client (e.g. http://localhost:8080)")):"mlnet"===t.toLowerCase()?(o="mlnet",e("#torrent_path_option").hide(),e("#torrent_label_option").hide(),e("#torrent_verify_cert_option").hide(),e("#torrent_verify_deluge").hide(),e("#torrent_verify_rtorrent").hide(),e("#torrent_label_anime_option").hide(),e("#torrent_paused_option").hide(),e("#host_desc_torrent").text("URL to your MLDonkey (e.g. http://localhost:4080)")):"putio"===t.toLowerCase()&&(o="putio",e("#torrent_path_option").hide(),e("#torrent_label_option").hide(),e("#torrent_verify_cert_option").hide(),e("#torrent_verify_deluge").hide(),e("#torrent_verify_rtorrent").hide(),e("#torrent_label_anime_option").hide(),e("#torrent_paused_option").hide(),e("#torrent_host_option").hide(),e("#host_desc_torrent").text("URL to your putio client (e.g. http://localhost:8080)")),e("#host_title").text(o+" host:port"),e("#username_title").text(o+" username"),e("#password_title").text(o+" password"),e("#torrent_client").text(o),e("#rpcurl_title").text(o+" RPC URL"),i="#options_torrent_clients"),e(i).show()},rtorrentScgi:function(){"rtorrent"===e("#torrent_method :selected").val().toLowerCase()&&("scgi://"===e("#torrent_host").prop("value").substr(0,7)?(e("#torrent_username_option").hide(),e("#torrent_username").prop("value",""),e("#torrent_password_option").hide(),e("#torrent_password").prop("value",""),e("#torrent_auth_type_option").hide(),e("#torrent_auth_type option[value=none]").attr("selected","selected")):(e("#torrent_username_option").show(),e("#torrent_password_option").show(),e("#torrent_auth_type_option").show()))}},postprocessing:{init:function(){e("#unpack").on("change",function(){e(this).prop("checked")?t.config.postprocessing.israr_supported():e("#unpack").qtip("toggle",!1)}),e("#name_presets").on("change",function(){t.config.postprocessing.setup_naming()}),e("#name_abd_presets").on("change",function(){t.config.postprocessing.setup_abd_naming()}),e("#naming_custom_abd").on("change",function(){t.config.postprocessing.setup_abd_naming()}),e("#name_sports_presets").on("change",function(){t.config.postprocessing.setup_sports_naming()}),e("#naming_custom_sports").on("change",function(){t.config.postprocessing.setup_sports_naming()}),e("#name_anime_presets").on("change",function(){t.config.postprocessing.setup_anime_naming()}),e("#naming_custom_anime").on("change",function(){t.config.postprocessing.setup_anime_naming()}),e('input[name="naming_anime"]').on("click",function(){t.config.postprocessing.setup_anime_naming()}),e("#naming_multi_ep").change(t.config.postprocessing.fill_examples),e("#naming_pattern").focusout(t.config.postprocessing.fill_examples),e("#naming_pattern").keyup(function(){t.config.postprocessing.typewatch(function(){t.config.postprocessing.fill_examples()},500)}),e("#naming_anime_multi_ep").change(t.config.postprocessing.fill_anime_examples),e("#naming_anime_pattern").focusout(t.config.postprocessing.fill_anime_examples),e("#naming_anime_pattern").keyup(function(){t.config.postprocessing.typewatch(function(){t.config.postprocessing.fill_anime_examples()},500)}),e("#naming_abd_pattern").focusout(t.config.postprocessing.fill_examples),e("#naming_abd_pattern").keyup(function(){t.config.postprocessing.typewatch(function(){t.config.postprocessing.fill_abd_examples()},500)}),e("#naming_sports_pattern").focusout(t.config.postprocessing.fill_examples),e("#naming_sports_pattern").keyup(function(){t.config.postprocessing.typewatch(function(){t.config.postprocessing.fill_sports_examples()},500)}),e("#naming_anime_pattern").focusout(t.config.postprocessing.fill_examples),e("#naming_anime_pattern").keyup(function(){t.config.postprocessing.typewatch(function(){t.config.postprocessing.fill_anime_examples()},500)}),e("#show_naming_key").on("click",function(){e("#naming_key").toggle()}),e("#show_naming_abd_key").on("click",function(){e("#naming_abd_key").toggle()}),e("#show_naming_sports_key").on("click",function(){e("#naming_sports_key").toggle()}),e("#show_naming_anime_key").on("click",function(){e("#naming_anime_key").toggle()}),e("#do_custom").on("click",function(){e("#naming_pattern").val(e("#name_presets :selected").attr("id")),e("#naming_custom").show(),e("#naming_pattern").focus()}),t.config.postprocessing.setup_naming(),t.config.postprocessing.setup_abd_naming(),t.config.postprocessing.setup_sports_naming(),t.config.postprocessing.setup_anime_naming(),e("#metadataType").on("change keyup",function(){t.config.postprocessing.showHideMetadata()}),t.config.postprocessing.showHideMetadata(),e(".metadata_checkbox").on("click",function(){t.config.postprocessing.refreshMetadataConfig(!1)}),t.config.postprocessing.refreshMetadataConfig(!0),e("img[title]").qtip({position:{viewport:e(window),at:"bottom center",my:"top right"},style:{tip:{corner:!0,method:"polygon"},classes:"qtip-shadow qtip-dark"}}),e("i[title]").qtip({position:{viewport:e(window),at:"top center",my:"bottom center"},style:{tip:{corner:!0,method:"polygon"},classes:"qtip-rounded qtip-shadow ui-tooltip-sb"}}),e(".custom-pattern,#unpack").qtip({content:"validating...",show:{event:!1,ready:!1},hide:!1,position:{viewport:e(window),at:"center left",my:"center right"},style:{tip:{corner:!0,method:"polygon"},classes:"qtip-rounded qtip-shadow qtip-red"}}),e("#tv_download_dir").fileBrowser({title:"Select TV Download Directory"})},typewatch:function(){var e=0;return function(t,o){clearTimeout(e),e=setTimeout(t,o)}},israr_supported:function(){e.get("/config/postProcessing/isRarSupported",function(t){"supported"!==t&&(e("#unpack").qtip("option",{"content.text":"Unrar Executable not found.","style.classes":"qtip-rounded qtip-shadow qtip-red"}),e("#unpack").qtip("toggle",!0),e("#unpack").css("background-color","#FFFFDD"))})},fill_examples:function(){var t=e("#naming_pattern").val(),o=e("#naming_multi_ep :selected").val(),i=e('input[name="naming_anime"]:checked').val();e.get("/config/postProcessing/testNaming",{pattern:t,anime_type:3},function(t){t?(e("#naming_example").text(t+".ext"),e("#naming_example_div").show()):e("#naming_example_div").hide()}),e.get("/config/postProcessing/testNaming",{pattern:t,multi:o,anime_type:3},function(t){t?(e("#naming_example_multi").text(t+".ext"),e("#naming_example_multi_div").show()):e("#naming_example_multi_div").hide()}),e.get("/config/postProcessing/isNamingValid",{pattern:t,multi:o,anime_type:i},function(t){"invalid"===t?(e("#naming_pattern").qtip("option",{"content.text":"This pattern is invalid.","style.classes":"qtip-rounded qtip-shadow qtip-red"}),e("#naming_pattern").qtip("toggle",!0),e("#naming_pattern").css("background-color","#FFDDDD")):"seasonfolders"===t?(e("#naming_pattern").qtip("option",{"content.text":'This pattern would be invalid without the folders, using it will force "Flatten" off for all shows.',"style.classes":"qtip-rounded qtip-shadow qtip-red"}),e("#naming_pattern").qtip("toggle",!0),e("#naming_pattern").css("background-color","#FFFFDD")):(e("#naming_pattern").qtip("option",{"content.text":"This pattern is valid.","style.classes":"qtip-rounded qtip-shadow qtip-green"}),e("#naming_pattern").qtip("toggle",!1),e("#naming_pattern").css("background-color","#FFFFFF"))})},fill_abd_examples:function(){var t=e("#naming_abd_pattern").val();e.get("/config/postProcessing/testNaming",{pattern:t,abd:"True"},function(t){t?(e("#naming_abd_example").text(t+".ext"),e("#naming_abd_example_div").show()):e("#naming_abd_example_div").hide()}),e.get("/config/postProcessing/isNamingValid",{pattern:t,abd:"True"},function(t){"invalid"===t?(e("#naming_abd_pattern").qtip("option",{"content.text":"This pattern is invalid.","style.classes":"qtip-rounded qtip-shadow qtip-red"}),e("#naming_abd_pattern").qtip("toggle",!0),e("#naming_abd_pattern").css("background-color","#FFDDDD")):"seasonfolders"===t?(e("#naming_abd_pattern").qtip("option",{"content.text":'This pattern would be invalid without the folders, using it will force "Flatten" off for all shows.',"style.classes":"qtip-rounded qtip-shadow qtip-red"}),e("#naming_abd_pattern").qtip("toggle",!0),e("#naming_abd_pattern").css("background-color","#FFFFDD")):(e("#naming_abd_pattern").qtip("option",{"content.text":"This pattern is valid.",
"style.classes":"qtip-rounded qtip-shadow qtip-green"}),e("#naming_abd_pattern").qtip("toggle",!1),e("#naming_abd_pattern").css("background-color","#FFFFFF"))})},fill_sports_examples:function(){var t=e("#naming_sports_pattern").val();e.get("/config/postProcessing/testNaming",{pattern:t,sports:"True"},function(t){t?(e("#naming_sports_example").text(t+".ext"),e("#naming_sports_example_div").show()):e("#naming_sports_example_div").hide()}),e.get("/config/postProcessing/isNamingValid",{pattern:t,sports:"True"},function(t){"invalid"===t?(e("#naming_sports_pattern").qtip("option",{"content.text":"This pattern is invalid.","style.classes":"qtip-rounded qtip-shadow qtip-red"}),e("#naming_sports_pattern").qtip("toggle",!0),e("#naming_sports_pattern").css("background-color","#FFDDDD")):"seasonfolders"===t?(e("#naming_sports_pattern").qtip("option",{"content.text":'This pattern would be invalid without the folders, using it will force "Flatten" off for all shows.',"style.classes":"qtip-rounded qtip-shadow qtip-red"}),e("#naming_sports_pattern").qtip("toggle",!0),e("#naming_sports_pattern").css("background-color","#FFFFDD")):(e("#naming_sports_pattern").qtip("option",{"content.text":"This pattern is valid.","style.classes":"qtip-rounded qtip-shadow qtip-green"}),e("#naming_sports_pattern").qtip("toggle",!1),e("#naming_sports_pattern").css("background-color","#FFFFFF"))})},fill_anime_examples:function(){var t=e("#naming_anime_pattern").val(),o=e("#naming_anime_multi_ep :selected").val(),i=e('input[name="naming_anime"]:checked').val();e.get("/config/postProcessing/testNaming",{pattern:t,anime_type:i},function(t){t?(e("#naming_example_anime").text(t+".ext"),e("#naming_example_anime_div").show()):e("#naming_example_anime_div").hide()}),e.get("/config/postProcessing/testNaming",{pattern:t,multi:o,anime_type:i},function(t){t?(e("#naming_example_multi_anime").text(t+".ext"),e("#naming_example_multi_anime_div").show()):e("#naming_example_multi_anime_div").hide()}),e.get("/config/postProcessing/isNamingValid",{pattern:t,multi:o,anime_type:i},function(t){"invalid"===t?(e("#naming_pattern").qtip("option",{"content.text":"This pattern is invalid.","style.classes":"qtip-rounded qtip-shadow qtip-red"}),e("#naming_pattern").qtip("toggle",!0),e("#naming_pattern").css("background-color","#FFDDDD")):"seasonfolders"===t?(e("#naming_pattern").qtip("option",{"content.text":'This pattern would be invalid without the folders, using it will force "Flatten" off for all shows.',"style.classes":"qtip-rounded qtip-shadow qtip-red"}),e("#naming_pattern").qtip("toggle",!0),e("#naming_pattern").css("background-color","#FFFFDD")):(e("#naming_pattern").qtip("option",{"content.text":"This pattern is valid.","style.classes":"qtip-rounded qtip-shadow qtip-green"}),e("#naming_pattern").qtip("toggle",!1),e("#naming_pattern").css("background-color","#FFFFFF"))})},setup_naming:function(){"Custom..."===e("#name_presets :selected").val()?e("#naming_custom").show():(e("#naming_custom").hide(),e("#naming_pattern").val(e("#name_presets :selected").attr("id"))),t.config.postprocessing.fill_examples()},setup_abd_naming:function(){"Custom..."===e("#name_abd_presets :selected").val()?e("#naming_abd_custom").show():(e("#naming_abd_custom").hide(),e("#naming_abd_pattern").val(e("#name_abd_presets :selected").attr("id"))),t.config.postprocessing.fill_abd_examples()},setup_sports_naming:function(){"Custom..."===e("#name_sports_presets :selected").val()?e("#naming_sports_custom").show():(e("#naming_sports_custom").hide(),e("#naming_sports_pattern").val(e("#name_sports_presets :selected").attr("id"))),t.config.postprocessing.fill_sports_examples()},setup_anime_naming:function(){"Custom..."===e("#name_anime_presets :selected").val()?e("#naming_anime_custom").show():(e("#naming_anime_custom").hide(),e("#naming_anime_pattern").val(e("#name_anime_presets :selected").attr("id"))),t.config.postprocessing.fill_anime_examples()},showHideMetadata:function(){e(".metadataDiv").each(function(){var t=e(this).attr("id");e("#metadataType :selected").val()===t?e(this).show():e(this).hide()})},refreshMetadataConfig:function(o){var i=0,n="";e(".metadataDiv").each(function(){var t=e(this).attr("id"),o=[],r=e("#"+t+"_show_metadata").prop("checked"),a=e("#"+t+"_episode_metadata").prop("checked"),s=e("#"+t+"_fanart").prop("checked"),l=e("#"+t+"_poster").prop("checked"),c=e("#"+t+"_banner").prop("checked"),d=e("#"+t+"_episode_thumbnails").prop("checked"),p=e("#"+t+"_season_posters").prop("checked"),h=e("#"+t+"_season_banners").prop("checked"),u=e("#"+t+"_season_all_poster").prop("checked"),f=e("#"+t+"_season_all_banner").prop("checked"),g=e("#"+t+"_enabled").prop("checked");o.push(r?"1":"0"),o.push(a?"1":"0"),o.push(s?"1":"0"),o.push(l?"1":"0"),o.push(c?"1":"0"),o.push(d?"1":"0"),o.push(p?"1":"0"),o.push(h?"1":"0"),o.push(u?"1":"0"),o.push(f?"1":"0"),o.push(g?"1":"0");for(var m=0,_=0;_<o.length;_++)m+=parseInt(o[_]);m>i&&(i=m,n=t),e("#"+t+"_eg_show_metadata").attr("class",r?"enabled":"disabled"),e("#"+t+"_eg_episode_metadata").attr("class",a?"enabled":"disabled"),e("#"+t+"_eg_fanart").attr("class",s?"enabled":"disabled"),e("#"+t+"_eg_poster").attr("class",l?"enabled":"disabled"),e("#"+t+"_eg_banner").attr("class",c?"enabled":"disabled"),e("#"+t+"_eg_episode_thumbnails").attr("class",d?"enabled":"disabled"),e("#"+t+"_eg_season_posters").attr("class",p?"enabled":"disabled"),e("#"+t+"_eg_season_banners").attr("class",h?"enabled":"disabled"),e("#"+t+"_eg_season_all_poster").attr("class",u?"enabled":"disabled"),e("#"+t+"_eg_season_all_banner").attr("class",f?"enabled":"disabled"),e("#"+t+"_data").val(o.join("|"))}),""!==n&&o&&(e("#metadataType option[value="+n+"]").attr("selected","selected"),t.config.postprocessing.showHideMetadata())}},notifications:{init:function(){e("#testGrowl").click(function(){var o=e.trim(e("#growl_host").val()),i=e.trim(e("#growl_password").val());if(!o)return e("#testGrowl-result").html("Please fill out the necessary fields above."),void e("#growl_host").addClass("warning");e("#growl_host").removeClass("warning"),e(this).prop("disabled",!0),e("#testGrowl-result").html(t.loading),e.get("/home/testGrowl",{host:o,password:i}).done(function(t){e("#testGrowl-result").html(t),e("#testGrowl").prop("disabled",!1)})}),e("#testProwl").click(function(){var o=e.trim(e("#prowl_api").val()),i=e("#prowl_priority").val();if(!o)return e("#testProwl-result").html("Please fill out the necessary fields above."),void e("#prowl_api").addClass("warning");e("#prowl_api").removeClass("warning"),e(this).prop("disabled",!0),e("#testProwl-result").html(t.loading),e.get("/home/testProwl",{prowl_api:o,prowl_priority:i}).done(function(t){e("#testProwl-result").html(t),e("#testProwl").prop("disabled",!1)})}),e("#testKODI").click(function(){var o=e.trim(e("#kodi_host").val()),i=e.trim(e("#kodi_username").val()),n=e.trim(e("#kodi_password").val());if(!o)return e("#testKODI-result").html("Please fill out the necessary fields above."),void e("#kodi_host").addClass("warning");e("#kodi_host").removeClass("warning"),e(this).prop("disabled",!0),e("#testKODI-result").html(t.loading),e.get("/home/testKODI",{host:o,username:i,password:n}).done(function(t){e("#testKODI-result").html(t),e("#testKODI").prop("disabled",!1)})}),e("#testPMC").click(function(){var o=e.trim(e("#plex_host").val()),i=e.trim(e("#plex_client_username").val()),n=e.trim(e("#plex_client_password").val());if(!o)return e("#testPMC-result").html("Please fill out the necessary fields above."),void e("#plex_host").addClass("warning");e("#plex_host").removeClass("warning"),e(this).prop("disabled",!0),e("#testPMC-result").html(t.loading),e.get("/home/testPMC",{host:o,username:i,password:n}).done(function(t){e("#testPMC-result").html(t),e("#testPMC").prop("disabled",!1)})}),e("#testPMS").click(function(){var o=e.trim(e("#plex_server_host").val()),i=e.trim(e("#plex_username").val()),n=e.trim(e("#plex_password").val()),r=e.trim(e("#plex_server_token").val());if(!o)return e("#testPMS-result").html("Please fill out the necessary fields above."),void e("#plex_server_host").addClass("warning");e("#plex_server_host").removeClass("warning"),e(this).prop("disabled",!0),e("#testPMS-result").html(t.loading),e.get("/home/testPMS",{host:o,username:i,password:n,plex_server_token:r}).done(function(t){e("#testPMS-result").html(t),e("#testPMS").prop("disabled",!1)})}),e("#testEMBY").click(function(){var o=e("#emby_host").val(),i=e("#emby_apikey").val();if(!o||!i)return e("#testEMBY-result").html("Please fill out the necessary fields above."),o?e("#emby_host").removeClass("warning"):e("#emby_host").addClass("warning"),void(i?e("#emby_apikey").removeClass("warning"):e("#emby_apikey").addClass("warning"));e("#emby_host,#emby_apikey").removeClass("warning"),e(this).prop("disabled",!0),e("#testEMBY-result").html(t.loading),e.get("/home/testEMBY",{host:o,emby_apikey:i}).done(function(t){e("#testEMBY-result").html(t),e("#testEMBY").prop("disabled",!1)})}),e("#testBoxcar").click(function(){var o=e.trim(e("#boxcar_username").val());if(!o)return e("#testBoxcar-result").html("Please fill out the necessary fields above."),void e("#boxcar_username").addClass("warning");e("#boxcar_username").removeClass("warning"),e(this).prop("disabled",!0),e("#testBoxcar-result").html(t.loading),e.get("/home/testBoxcar",{username:o}).done(function(t){e("#testBoxcar-result").html(t),e("#testBoxcar").prop("disabled",!1)})}),e("#testBoxcar2").click(function(){var o=e.trim(e("#boxcar2_accesstoken").val());if(!o)return e("#testBoxcar2-result").html("Please fill out the necessary fields above."),void e("#boxcar2_accesstoken").addClass("warning");e("#boxcar2_accesstoken").removeClass("warning"),e(this).prop("disabled",!0),e("#testBoxcar2-result").html(t.loading),e.get("/home/testBoxcar2",{accesstoken:o}).done(function(t){e("#testBoxcar2-result").html(t),e("#testBoxcar2").prop("disabled",!1)})}),e("#testPushover").click(function(){var o=e("#pushover_userkey").val(),i=e("#pushover_apikey").val();if(!o||!i)return e("#testPushover-result").html("Please fill out the necessary fields above."),o?e("#pushover_userkey").removeClass("warning"):e("#pushover_userkey").addClass("warning"),void(i?e("#pushover_apikey").removeClass("warning"):e("#pushover_apikey").addClass("warning"));e("#pushover_userkey,#pushover_apikey").removeClass("warning"),e(this).prop("disabled",!0),e("#testPushover-result").html(t.loading),e.get("/home/testPushover",{userKey:o,apiKey:i}).done(function(t){e("#testPushover-result").html(t),e("#testPushover").prop("disabled",!1)})}),e("#testLibnotify").click(function(){e("#testLibnotify-result").html(t.loading),e.get("/home/testLibnotify",function(t){e("#testLibnotify-result").html(t)})}),e("#twitterStep1").click(function(){e("#testTwitter-result").html(t.loading),e.get("/home/twitterStep1",function(e){window.open(e)}).done(function(){e("#testTwitter-result").html("<b>Step1:</b> Confirm Authorization")})}),e("#twitterStep2").click(function(){var o=e.trim(e("#twitter_key").val());if(!o)return e("#testTwitter-result").html("Please fill out the necessary fields above."),void e("#twitter_key").addClass("warning");e("#twitter_key").removeClass("warning"),e("#testTwitter-result").html(t.loading),e.get("/home/twitterStep2",{key:o},function(t){e("#testTwitter-result").html(t)})}),e("#testTwitter").click(function(){e.get("/home/testTwitter",function(t){e("#testTwitter-result").html(t)})}),e("#settingsNMJ").click(function(){if(!e("#nmj_host").val())return alert("Please fill in the Popcorn IP address"),void e("#nmj_host").focus();e("#testNMJ-result").html(t.loading);var o=e("#nmj_host").val();e.get("/home/settingsNMJ",{host:o},function(t){null===t&&(e("#nmj_database").removeAttr("readonly"),e("#nmj_mount").removeAttr("readonly"));var o=e.parseJSON(t);e("#testNMJ-result").html(o.message),e("#nmj_database").val(o.database),e("#nmj_mount").val(o.mount),o.database?e("#nmj_database").attr("readonly",!0):e("#nmj_database").removeAttr("readonly"),o.mount?e("#nmj_mount").attr("readonly",!0):e("#nmj_mount").removeAttr("readonly")})}),e("#testNMJ").click(function(){var o=e.trim(e("#nmj_host").val()),i=e("#nmj_database").val(),n=e("#nmj_mount").val();if(!o)return e("#testNMJ-result").html("Please fill out the necessary fields above."),void e("#nmj_host").addClass("warning");e("#nmj_host").removeClass("warning"),e(this).prop("disabled",!0),e("#testNMJ-result").html(t.loading),e.get("/home/testNMJ",{host:o,database:i,mount:n}).done(function(t){e("#testNMJ-result").html(t),e("#testNMJ").prop("disabled",!1)})}),e("#settingsNMJv2").click(function(){if(!e("#nmjv2_host").val())return alert("Please fill in the Popcorn IP address"),void e("#nmjv2_host").focus();e("#testNMJv2-result").html(t.loading);for(var o,i=e("#nmjv2_host").val(),n=document.getElementsByName("nmjv2_dbloc"),r=0;r<n.length;r++)if(n[r].checked){o=n[r].value;break}var a=e("#NMJv2db_instance").val();e.get("/home/settingsNMJv2",{host:i,dbloc:o,instance:a},function(t){null===t&&e("#nmjv2_database").removeAttr("readonly");var o=e.parseJSON(t);e("#testNMJv2-result").html(o.message),e("#nmjv2_database").val(o.database),o.database?e("#nmjv2_database").attr("readonly",!0):e("#nmjv2_database").removeAttr("readonly")})}),e("#testNMJv2").click(function(){var o=e.trim(e("#nmjv2_host").val());if(!o)return e("#testNMJv2-result").html("Please fill out the necessary fields above."),void e("#nmjv2_host").addClass("warning");e("#nmjv2_host").removeClass("warning"),e(this).prop("disabled",!0),e("#testNMJv2-result").html(t.loading),e.get("/home/testNMJv2",{host:o}).done(function(t){e("#testNMJv2-result").html(t),e("#testNMJv2").prop("disabled",!1)})}),e("#testFreeMobile").click(function(){var o=e.trim(e("#freemobile_id").val()),i=e.trim(e("#freemobile_apikey").val());if(!o||!i)return e("#testFreeMobile-result").html("Please fill out the necessary fields above."),o?e("#freemobile_id").removeClass("warning"):e("#freemobile_id").addClass("warning"),void(i?e("#freemobile_apikey").removeClass("warning"):e("#freemobile_apikey").addClass("warning"));e("#freemobile_id,#freemobile_apikey").removeClass("warning"),e(this).prop("disabled",!0),e("#testFreeMobile-result").html(t.loading),e.get("/home/testFreeMobile",{freemobile_id:o,freemobile_apikey:i}).done(function(t){e("#testFreeMobile-result").html(t),e("#testFreeMobile").prop("disabled",!1)})}),e("#TraktGetPin").click(function(){var t=e("#trakt_pin_url").val();window.open(t,"popUp","toolbar=no, scrollbars=no, resizable=no, top=200, left=200, width=650, height=550"),e("#trakt_pin").removeClass("hide")}),e("#trakt_pin").on("keyup change",function(){0!==e("#trakt_pin").val().length?(e("#TraktGetPin").addClass("hide"),e("#authTrakt").removeClass("hide")):(e("#TraktGetPin").removeClass("hide"),e("#authTrakt").addClass("hide"))}),e("#authTrakt").click(function(){var t=e("#trakt_pin").val();0!==t.length&&e.get("/home/getTraktToken",{trakt_pin:t}).done(function(t){e("#testTrakt-result").html(t),e("#authTrakt").addClass("hide"),e("#trakt_pin").addClass("hide"),e("#TraktGetPin").addClass("hide")})}),e("#testTrakt").click(function(){var o=e.trim(e("#trakt_username").val()),i=e.trim(e("#trakt_blacklist_name").val());return o?/\s/g.test(i)?(e("#testTrakt-result").html("Check blacklist name; the value need to be a trakt slug"),void e("#trakt_blacklist_name").addClass("warning")):(e("#trakt_username").removeClass("warning"),e("#trakt_blacklist_name").removeClass("warning"),e(this).prop("disabled",!0),e("#testTrakt-result").html(t.loading),void e.get("/home/testTrakt",{username:o,blacklist_name:i}).done(function(t){e("#testTrakt-result").html(t),e("#testTrakt").prop("disabled",!1)})):(e("#testTrakt-result").html("Please fill out the necessary fields above."),void(o?e("#trakt_username").removeClass("warning"):e("#trakt_username").addClass("warning")))}),e("#testEmail").click(function(){var o,i,n,r,a,s,l,c,d;o=e("#testEmail-result"),o.html(t.loading),i=e("#email_host").val(),i=i.length>0?i:null,n=e("#email_port").val(),n=n.length>0?n:null,r=e("#email_tls").prop("checked"),a=e("#email_from").val(),a=a.length>0?a:"root@localhost",s=e("#email_user").val().trim(),l=e("#email_password").val(),c="",null===i&&(c+='<li style="color: red;">You must specify an SMTP hostname!</li>'),null===n?c+='<li style="color: red;">You must specify an SMTP port!</li>':(null===n.match(/^\d+$/)||parseInt(n,10)>65535)&&(c+='<li style="color: red;">SMTP port must be between 0 and 65535!</li>'),c.length>0?(c="<ol>"+c+"</ol>",o.html(c)):(d=prompt("Enter an email address to send the test to:",null),null===d||0===d.length||null===d.match(/.*@.*/)?o.html('<p style="color: red;">You must provide a recipient email address!</p>'):e.get("/home/testEmail",{host:i,port:n,smtp_from:a,use_tls:r,user:s,pwd:l,to:d},function(t){e("#testEmail-result").html(t)}))}),e("#testNMA").click(function(){var o=e.trim(e("#nma_api").val()),i=e("#nma_priority").val();if(!o)return e("#testNMA-result").html("Please fill out the necessary fields above."),void e("#nma_api").addClass("warning");e("#nma_api").removeClass("warning"),e(this).prop("disabled",!0),e("#testNMA-result").html(t.loading),e.get("/home/testNMA",{nma_api:o,nma_priority:i}).done(function(t){e("#testNMA-result").html(t),e("#testNMA").prop("disabled",!1)})}),e("#testPushalot").click(function(){var o=e.trim(e("#pushalot_authorizationtoken").val());if(!o)return e("#testPushalot-result").html("Please fill out the necessary fields above."),void e("#pushalot_authorizationtoken").addClass("warning");e("#pushalot_authorizationtoken").removeClass("warning"),e(this).prop("disabled",!0),e("#testPushalot-result").html(t.loading),e.get("/home/testPushalot",{authorizationToken:o}).done(function(t){e("#testPushalot-result").html(t),e("#testPushalot").prop("disabled",!1)})}),e("#testPushbullet").click(function(){var o=e.trim(e("#pushbullet_api").val());if(!o)return e("#testPushbullet-result").html("Please fill out the necessary fields above."),void e("#pushbullet_api").addClass("warning");e("#pushbullet_api").removeClass("warning"),e(this).prop("disabled",!0),e("#testPushbullet-result").html(t.loading),e.get("/home/testPushbullet",{api:o}).done(function(t){e("#testPushbullet-result").html(t),e("#testPushbullet").prop("disabled",!1)})}),e("#getPushbulletDevices").click(function(){t.config.notifications.get_pushbullet_devices("Device list updated. Please choose a device to push to.")}),t.config.notifications.get_pushbullet_devices(),e("#email_show").on("change",function(){var t=parseInt(e("#email_show").val(),10);e.getJSON("/home/loadShowNotifyLists",function(o){o._size>0&&e("#email_show_list").val(t>=0?o[t.toString()].list:"")})}),e("#prowl_show").on("change",function(){var t=parseInt(e("#prowl_show").val(),10);e.getJSON("/home/loadShowNotifyLists",function(o){o._size>0&&e("#prowl_show_list").val(t>=0?o[t.toString()].prowl_notify_list:"")})}),t.config.notifications.load_show_notify_lists(),e("#email_show_save").click(function(){e.post("/home/saveShowNotifyList",{show:e("#email_show").val(),emails:e("#email_show_list").val()},function(){t.config.notifications.load_show_notify_lists()})}),e("#use_plex").click(function(){e(this).is(":checked")?e(".plexinfo").removeClass("hide"):e(".plexinfo").addClass("hide")})},get_pushbullet_devices:function(o){o&&e("#testPushbullet-result").html(t.loading);var i=e("#pushbullet_api").val();if(!i)return e("#testPushbullet-result").html("You didn't supply a Pushbullet api key"),e("#pushbullet_api").focus(),!1;e.get("/home/getPushbulletDevices",{api:i},function(t){var i=e.parseJSON(t).devices,n=e("#pushbullet_device").val();e("#pushbullet_device_list").html("");for(var r=0;r<i.length;r++)!0===i[r].active&&(n===i[r].iden?e("#pushbullet_device_list").append('<option value="'+i[r].iden+'" selected>'+i[r].nickname+"</option>"):e("#pushbullet_device_list").append('<option value="'+i[r].iden+'">'+i[r].nickname+"</option>"));""===n?e("#pushbullet_device_list").prepend('<option value="" selected>All devices</option>'):e("#pushbullet_device_list").prepend('<option value="">All devices</option>'),o&&e("#testPushbullet-result").html(o)}),e("#pushbullet_device_list").change(function(){e("#pushbullet_device").val(e("#pushbullet_device_list").val()),e("#testPushbullet-result").html("Don't forget to save your new pushbullet settings.")})},load_show_notify_lists:function(){e.getJSON("/home/loadShowNotifyLists",function(t){var o,i;if(0!==t._size){var n=[];for(i in t)t.hasOwnProperty(i)&&"_"!==i.charAt(0)&&n.push(t[i]);var r=n.sort(function(e,t){return e.name<t.name?-1:e.name>t.name?1:0});o='<option value="-1">-- Select --</option>';for(i in r)r.hasOwnProperty(i)&&r[i].id&&r[i].name&&(o+='<option value="'+r[i].id+'">'+e("<div/>").text(r[i].name).html()+"</option>");e("#email_show").html(o),e("#email_show_list").val(""),e("#prowl_show").html(o),e("#prowl_show_list").val("")}})}},backup_restore:function(){e("#Backup").click(function(){e("#Backup").attr("disabled",!0),e("#Backup-result").html(t.loading);var o=e("#backupDir").val();e.get("/config/backuprestore/backup",{backupDir:o}).done(function(t){e("#Backup-result").html(t),e("#Backup").attr("disabled",!1)})}),e("#Restore").click(function(){e("#Restore").attr("disabled",!0),e("#Restore-result").html(t.loading);var o=e("#backupFile").val();e.get("/config/backuprestore/restore",{backupFile:o}).done(function(t){e("#Restore-result").html(t),e("#Restore").attr("disabled",!1)})}),e("#backupDir").fileBrowser({title:"Select backup folder to save to",key:"backupPath"}),e("#backupFile").fileBrowser({title:"Select backup files to restore",key:"backupFile",includeFiles:1})},providers:{newznabProviders:[],torrentRssProviders:[],newznabProvidersCapabilities:[],init:function(){e(document).on("change",".newznab_key",function(){var o=e(this).attr("id");o=o.substring(0,o.length-"_key".length);var i=e("#"+o+"_url").val(),n=e("#"+o+"_cat").val(),r=e(this).val();t.config.providers.updateNewznabProvider(o,i,r,n)}),e("#newznab_key,#newznab_url").change(function(){var o=e("#editANewznabProvider :selected").val();if("addNewznab"!==o){var i=e("#newznab_url").val(),n=e("#newznab_key").val(),r=e("#newznab_cat option").map(function(t,o){return e(o).text()}).toArray().join(",");t.config.providers.updateNewznabProvider(o,i,n,r)}}),e("#torrentrss_url,#torrentrss_cookies,#torrentrss_titleTAG").change(function(){var o=e("#editATorrentRssProvider :selected").val();if("addTorrentRss"!==o){var i=e("#torrentrss_url").val(),n=e("#torrentrss_cookies").val(),r=e("#torrentrss_titleTAG").val();t.config.providers.updateTorrentRssProvider(o,i,n,r)}}),e(document).on("change","#editAProvider",function(){t.config.providers.showHideProviders()}),e("#editANewznabProvider").change(function(){t.config.providers.populateNewznabSection()}),e("#editATorrentRssProvider").change(function(){t.config.providers.populateTorrentRssSection()}),e(document).on("click",".provider_enabler",function(){t.config.providers.refreshProviderList()}),e("#newznab_cat_update").click(function(){e("#newznab_cat option").each(function(){e(this).remove()});var o=[];e("#newznab_cap option:selected").each(function(){var t=e(this).val();o.push({text:t,value:t})}),t.config.providers.replaceProviderOptions("#newznab_cat",o);var i=e("#editANewznabProvider :selected").val();if("addNewznab"!==i){var n=e("#newznab_url").val(),r=e("#newznab_key").val(),a=e("#newznab_cat option").map(function(t,o){return e(o).text()}).toArray().join(",");e("#newznab_cat option:not([value])").remove(),t.config.providers.updateNewznabProvider(i,n,r,a)}}),e("#newznab_add").click(function(){var o=e.trim(e("#newznab_name").val()),i=e.trim(e("#newznab_url").val()),n=e.trim(e("#newznab_key").val()),r=e.trim(e("#newznab_cat option").map(function(t,o){return e(o).text()}).toArray().join(","));if(o&&i&&n){var a={name:o};e.getJSON("/config/providers/canAddNewznabProvider",a,function(e){if(void 0!==e.error)return void alert(e.error);t.config.providers.addNewznabProvider(e.success,o,i,n,r,"false"),t.config.providers.refreshEditAProvider()})}}),e(".newznab_delete").click(function(){var o=e("#editANewznabProvider :selected").val();t.config.providers.deleteNewznabProvider(o)}),e("#torrentrss_add").click(function(){var o=e("#torrentrss_name").val(),i=e("#torrentrss_url").val(),n=e("#torrentrss_cookies").val(),r=e("#torrentrss_titleTAG").val(),a={name:o,url:i,cookies:n,titleTAG:r};e.getJSON("/config/providers/canAddTorrentRssProvider",a,function(e){if(void 0!==e.error)return void alert(e.error);t.config.providers.addTorrentRssProvider(e.success,o,i,n,r,"false"),t.config.providers.refreshEditAProvider()})}),e(".torrentrss_delete").on("click",function(){t.config.providers.deleteTorrentRssProvider(e("#editATorrentRssProvider :selected").val()),t.config.providers.refreshEditAProvider()}),e(document).on("change","[class='providerDiv_tip'] input",function(){e("div .providerDiv [name="+e(this).attr("name")+"]").replaceWith(e(this).clone()),e("div .providerDiv [newznab_name="+e(this).attr("id")+"]").replaceWith(e(this).clone())}),e(document).on("change","[class='providerDiv_tip'] select",function(){e(this).find("option").each(function(){e(this).is(":selected")?e(this).prop("defaultSelected",!0):e(this).prop("defaultSelected",!1)}),e("div .providerDiv [name="+e(this).attr("name")+"]").empty().replaceWith(e(this).clone())}),e(document).on("change",".enabler",function(){e(this).is(":checked")?e(".content_"+e(this).attr("id")).each(function(){e(this).show()}):e(".content_"+e(this).attr("id")).each(function(){e(this).hide()})}),e(".enabler").each(function(){e(this).is(":checked")?e(".content_"+e(this).attr("id")).show():e(".content_"+e(this).attr("id")).hide()}),e(document).on("change",".seed_option",function(){var o=e(this).attr("id").split("_")[0];t.config.providers.makeTorrentOptionString(o)}),e("#provider_order_list").sortable({placeholder:"ui-state-highlight",update:function(){t.config.providers.refreshProviderList()}}),e("#provider_order_list").disableSelection(),e("#editANewznabProvider").length&&t.config.providers.populateNewznabSection();for(var o=t.getMeta("NEWZNAB_PROVIDERS").split("!!!"),i=0;i<o.length;i++){var n=o[i];n.length>0&&t.config.providers.addNewznabProvider.apply(this,n.split("|"))}for(var r=t.getMeta("TORRENTRSS_PROVIDERS").split("!!!"),a=0;a<r.length;a++){var s=r[a];s.length>0&&t.config.providers.addTorrentRssProvider.apply(this,s.split("|"))}t.config.providers.showHideProviders()},showHideProviders:function(){e(".providerDiv").each(function(){var t=e(this).attr("id");e("#editAProvider :selected").val()+"Div"===t?e(this).show():e(this).hide()})},findProvider:function(e,t){var o=!1;return e.forEach(function(e){e.name===t&&(o=!0),console.log(e.name+" while searching for: "+t)}),o},getNewznabCategories:function(o,i){var n=i[0],r=i[1],a=i[2];if(n&&r&&a){var s={url:r,name:n,key:a};e(".updating_categories").wrapInner("<span>"+t.loading+" Updating Categories ...</span>"),e.getJSON("/config/providers/getNewznabCategories",s,function(e){t.config.providers.updateNewznabCaps(e,i)}).always(function(){e(".updating_categories").empty()})}},addNewznabProvider:function(o,i,n,r,a,s,l){(n=e.trim(n))&&(/^https?:\/\//i.test(n)||(n="http://"+n),null===n.match("/$")&&(n+="/"),t.config.providers.newznabProviders[o]=[s,[i,n,r,a]],"true"!==s&&(e("#editANewznabProvider").addOption(o,i),t.config.providers.populateNewznabSection()),0===e("#provider_order_list > #"+o).length&&"false"!==l&&(e("#provider_order_list").append('<li class="ui-state-default" id="'+o+'"> <input type="checkbox" id="enable_'+o+'" class="provider_enabler" CHECKED> <a href="'+t.anon_url(n)+'" class="imgLink" target="_new"><img src="/images/providers/nzb.png" alt="'+i+'" width="16" height="16"></a> '+i+"</li>"),e("#provider_order_list").sortable("refresh")),t.config.providers.refreshProviderList())},updateNewznabProvider:function(e,o,i,n){t.config.providers.newznabProviders[e][1][1]=o,t.config.providers.newznabProviders[e][1][2]=i,t.config.providers.newznabProviders[e][1][3]=n,t.config.providers.populateNewznabSection(),t.config.providers.refreshProviderList()},deleteNewznabProvider:function(o){e("#editANewznabProvider").removeOption(o),t.config.providers.populateNewznabSection(),e("li").remove("#"+o),delete t.config.providers.newznabProviders[o],t.config.providers.refreshProviderList()},populateNewznabSection:function(){var o=e("#editANewznabProvider :selected").val(),i="",n="",r="";"addNewznab"===o?(i=["","",""],n="false",e("#newznab_add_div").show(),e("#newznab_update_div").hide(),e("#newznab_cat").attr("disabled","disabled"),e("#newznab_cap").attr("disabled","disabled"),e("#newznab_cat_update").attr("disabled","disabled"),e("#newznabcapdiv").hide(),e("#newznab_cat option").each(function(){e(this).remove()}),e("#newznab_cap option").each(function(){e(this).remove()})):(i=t.config.providers.newznabProviders[o][1],n=t.config.providers.newznabProviders[o][0],e("#newznab_add_div").hide(),e("#newznab_update_div").show(),e("#newznab_cat").removeAttr("disabled"),e("#newznab_cap").removeAttr("disabled"),e("#newznab_cat_update").removeAttr("disabled"),e("#newznabcapdiv").show()),e("#newznab_name").val(i[0]),e("#newznab_url").val(i[1]),e("#newznab_key").val(i[2]),r="string"==typeof i[3]?i[3].split(","):i[3];var a=[];r&&(r.forEach(function(e){""!==e&&a.push({text:e,value:e})}),t.config.providers.replaceProviderOptions("#newznab_cat",a)),"addNewznab"===o?(e("#newznab_name").removeAttr("disabled"),e("#newznab_url").removeAttr("disabled")):(e("#newznab_name").attr("disabled","disabled"),"true"===n?(e("#newznab_url").attr("disabled","disabled"),e("#newznab_delete").attr("disabled","disabled")):(e("#newznab_url").removeAttr("disabled"),e("#newznab_delete").removeAttr("disabled"),i[0]&&i[1]&&i[2]&&!t.config.providers.findProvider(t.config.providers.newznabProvidersCapabilities,i[0])&&t.config.providers.getNewznabCategories(n,i),t.config.providers.updateNewznabCaps(null,i)))},updateNewznabCaps:function(e,o){e&&!t.config.providers.findProvider(t.config.providers.newznabProvidersCapabilities,o[0])&&t.config.providers.newznabProvidersCapabilities.push({name:o[0],categories:e.tv_categories}),o[0]&&t.config.providers.newznabProvidersCapabilities.forEach(function(e){if(e.name&&e.name===o[0]&&e.categories instanceof Array){var i=[];e.categories.forEach(function(e){e.id&&e.name&&i.push({value:e.id,text:e.name+"("+e.id+")"})}),t.config.providers.replaceProviderOptions("#newznab_cap",i)}})},addTorrentRssProvider:function(o,i,n,r,a,s,l){t.config.providers.torrentRssProviders[o]=[i,n,r,a],"true"!==s&&(e("#editATorrentRssProvider").addOption(o,i),t.config.providers.populateTorrentRssSection()),0===e("#provider_order_list > #"+o).length&&"false"!==l&&(e("#provider_order_list").append('<li class="ui-state-default" id="'+o+'"> <input type="checkbox" id="enable_'+o+'" class="provider_enabler" CHECKED> <a href="'+t.anon_url(n)+'" class="imgLink" target="_new"><img src="/images/providers/torrent.png" alt="'+i+'" width="16" height="16"></a> '+i+"</li>"),e("#provider_order_list").sortable("refresh")),t.config.providers.refreshProviderList()},updateTorrentRssProvider:function(e,o,i,n){t.config.providers.torrentRssProviders[e][1]=o,t.config.providers.torrentRssProviders[e][2]=i,t.config.providers.torrentRssProviders[e][3]=n,t.config.providers.populateTorrentRssSection(),t.config.providers.refreshProviderList()},deleteTorrentRssProvider:function(o){e("#editATorrentRssProvider").removeOption(o),t.config.providers.populateTorrentRssSection(),e("li").remove("#"+o),delete t.config.providers.torrentRssProviders[o],t.config.providers.refreshProviderList()},populateTorrentRssSection:function(){var o=e("#editATorrentRssProvider :selected").val(),i="";"addTorrentRss"===o?(i=["","","","title"],e("#torrentrss_add_div").show(),e("#torrentrss_update_div").hide()):(i=t.config.providers.torrentRssProviders[o],e("#torrentrss_add_div").hide(),e("#torrentrss_update_div").show()),e("#torrentrss_name").val(i[0]),e("#torrentrss_url").val(i[1]),e("#torrentrss_cookies").val(i[2]),
e("#torrentrss_titleTAG").val(i[3]),"addTorrentRss"===o?(e("#torrentrss_name").removeAttr("disabled"),e("#torrentrss_url").removeAttr("disabled"),e("#torrentrss_cookies").removeAttr("disabled"),e("#torrentrss_titleTAG").removeAttr("disabled")):(e("#torrentrss_name").attr("disabled","disabled"),e("#torrentrss_url").removeAttr("disabled"),e("#torrentrss_cookies").removeAttr("disabled"),e("#torrentrss_titleTAG").removeAttr("disabled"),e("#torrentrss_delete").removeAttr("disabled"))},makeTorrentOptionString:function(t){var o=e(".providerDiv_tip #"+t+"_seed_ratio").prop("value"),i=e(".providerDiv_tip #"+t+"_seed_time").prop("value"),n=e(".providerDiv_tip #"+t+"_process_method").prop("value");e(".providerDiv_tip #"+t+"_option_string").val([o,i,n].join("|"))},refreshProviderList:function(){var o=e("#provider_order_list").sortable("toArray"),i=[],n=[];e.each(o,function(t,o){var n=+e("#enable_"+o).prop("checked")?"1":"0";i.push(o+":"+n)});for(var r in t.config.providers.newznabProviders)t.config.providers.newznabProviders.hasOwnProperty(r)&&n.push("newznab|"+t.config.providers.newznabProviders[r][1].join("|"));for(var a in t.config.providers.torrentRssProviders)t.config.providers.torrentRssProviders.hasOwnProperty(a)&&n.push("torrentrss|"+t.config.providers.torrentRssProviders[a].join("|"));e("#provider_strings").val(n.join(" ")),e("#provider_order").val(i.join(" ")),t.config.providers.refreshEditAProvider()},refreshEditAProvider:function(){e("#provider-list").empty();var o=e("#provider_order_list").sortable("toArray"),i=[];if(e.each(o,function(t,o){e("#enable_"+o).prop("checked")&&i.push(o)}),i.length>0){e("<select>").prop("id","editAProvider").addClass("form-control input-sm").appendTo("#provider-list");for(var n=0;n<i.length;n++){var r=i[n];e("#editAProvider").append(e("<option>").prop("value",r).text(e.trim(e("#"+r).text()).replace(/\s\*$/,"").replace(/\s\*\*$/,"")))}}else document.getElementsByClassName("component-desc")[0].innerHTML="No providers available to configure.";t.config.providers.showHideProviders()},replaceProviderOptions:function(t,o){e(t).empty(),e.each(o,function(o,i){e(t).append(e("<option></option>").attr("value",i.value).text(i.text))})}}},manage:{init:function(){},episode_statuses:function(){function t(t,o,i,n,r){var a="";return a+=' <tr class="'+e("#row_class").val()+" show-"+t+'">',a+='  <td class="tableleft" align="center"><input type="checkbox" class="'+t+'-epcheck" name="'+t+"-"+o+"x"+i+'"'+(r?" checked":"")+"></td>",a+="  <td>"+o+"x"+i+"</td>",a+='  <td class="tableright" style="width: 100%">'+n+"</td>",a+=" </tr>"}e(".allCheck").click(function(){var t=e(this).attr("id").split("-")[1];e("."+t+"-epcheck").prop("checked",e(this).prop("checked"))}),e(".get_more_eps").click(function(){var o=e(this).attr("id"),i=e("#allCheck-"+o).prop("checked"),n=e("tr#"+o),r=e(this).attr("data-clicked"),a=e(this).attr("value");r?"collapse"===a.toLowerCase()?(e("table tr").filter(".show-"+o).hide(),e(this).prop("value","Expand")):"expand"===a.toLowerCase()&&(e("table tr").filter(".show-"+o).show(),e(this).prop("value","Collapse")):(e.getJSON("/manage/showEpisodeStatuses",{indexer_id:o,whichStatus:e("#oldStatus").val()},function(r){e.each(r,function(r,a){e.each(a,function(e,a){n.after(t(o,r,e,a,i))})})}),e(this).attr("data-clicked",1),e(this).prop("value","Collapse"))}),e(".selectAllShows").click(function(){e(".allCheck").each(function(){e(this).prop("checked",!0)}),e('input[class*="-epcheck"]').each(function(){e(this).prop("checked",!0)})}),e(".unselectAllShows").click(function(){e(".allCheck").each(function(){e(this).prop("checked",!1)}),e('input[class*="-epcheck"]').each(function(){e(this).prop("checked",!1)})})},mass_update:function(){e("#massUpdateTable:has(tbody tr)").tablesorter({sortList:[[1,0]],textExtraction:{2:function(t){return e(t).find("span").text().toLowerCase()},3:function(t){return e(t).find("img").attr("alt")},4:function(t){return e(t).find("img").attr("alt")},5:function(t){return e(t).find("img").attr("alt")},6:function(t){return e(t).find("img").attr("alt")},7:function(t){return e(t).find("img").attr("alt")},8:function(t){return e(t).find("img").attr("alt")},9:function(t){return e(t).find("img").attr("alt")}},widgets:["zebra"],headers:{0:{sorter:!1},1:{sorter:"showNames"},2:{sorter:"quality"},3:{sorter:"sports"},4:{sorter:"scene"},5:{sorter:"anime"},6:{sorter:"flatfold"},7:{sorter:"archive_firstmatch"},8:{sorter:"paused"},9:{sorter:"subtitle"},10:{sorter:"default_ep_status"},11:{sorter:"status"},12:{sorter:!1},13:{sorter:!1},14:{sorter:!1},15:{sorter:!1},16:{sorter:!1},17:{sorter:!1}}}),e("#submitMassEdit").on("click",function(){var t=[];e(".showCheck:checked").each(function(){t.push(e(this).attr("id"))}),0!==t.length&&(window.location.href="massEdit?toEdit="+t.join("|"))}),e("#submitMassUpdate").on("click",function(){var t=[];e(".showCheck:checked").each(function(){t.push(e(this).attr("id"))}),0!==t.length&&(window.location.href="massUpdate?toUpdate="+t.join("|"))}),e("#submitMassRescan").on("click",function(){var t=[];e(".showCheck:checked").each(function(){t.push(e(this).attr("id"))}),0!==t.length&&(window.location.href="massUpdate?toRefresh="+t.join("|"))}),e("#submitMassRename").on("click",function(){var t=[];e(".showCheck:checked").each(function(){t.push(e(this).attr("id"))}),0!==t.length&&(window.location.href="massUpdate?toRename="+t.join("|"))}),e("#submitMassDelete").on("click",function(){var t=[];e(".showCheck:checked").each(function(){t.push(e(this).attr("id"))}),0!==t.length&&e.bootbox.confirm("You have selected to delete "+t.length+" show(s).  Are you sure you wish to continue? All files will be removed from your system.",function(e){e&&(window.location.href="massUpdate?toDelete="+t.join("|"))})}),e("#submitMassRemove").on("click",function(){var t=[];e(".showCheck:checked").each(function(){t.push(e(this).attr("id"))}),0!==t.length&&(window.location.href="massUpdate?toRemove="+t.join("|"))}),e(".bulkCheck").on("click",function(){e(".showCheck").each(function(){e(this).disabled||e(this).prop("checked",!this.checked)})})},mass_edit:{init:function(){e(".new_root_dir").change(function(){var o=t.manage.mass_edit.findDirIndex(e(this).attr("id"));e("#display_new_root_dir_"+o).html("<b>"+e(this).val()+"</b>")}),e(".edit_root_dir").click(function(){var o=t.manage.mass_edit.findDirIndex(e(this).attr("id")),i=e("#new_root_dir_"+o).val();e(this).nFileBrowser(t.manage.mass_edit.editRootDir,{initialDir:i,whichId:o})}),e(".delete_root_dir").click(function(){var o=t.manage.mass_edit.findDirIndex(e(this).attr("id"));e("#new_root_dir_"+o).val(null),e("#display_new_root_dir_"+o).html("<b>DELETED</b>")})},findDirIndex:function(e){var t=e.split("_");return t[t.length-1]},editRootDir:function(t,o){e("#new_root_dir_"+o.whichId).val(t),e("#new_root_dir_"+o.whichId).change()}},backlog_overview:function(){e("#pickShow").change(function(){var t=e(this).val();t&&e("html,body").animate({scrollTop:e("#show-"+t).offset().top-25},"slow")})},failed_downloads:function(){e("#failedTable:has(tbody tr)").tablesorter({widgets:["zebra"],sortList:[[0,0]],headers:{3:{sorter:!1}}}),e("#limit").change(function(){window.location.href="/manage/failedDownloads/?limit="+e(this).val()}),e("#submitMassRemove").on("click",function(){var t=[];if(e(".removeCheck").each(function(){e(this).prop("checked")&&t.push(e(this).attr("id").split("-")[1])}),0===t.length)return!1;window.location.href="/manage/failedDownloads?toRemove="+t.join("|")}),e(".bulkCheck").on("click",function(){var t=this,o=e(t).attr("id");e("."+o+":visible").each(function(){e(this).prop("checked",t.checked)})}),e(".removeCheck").forEach(function(t){var o=null;e(t).click(function(i){if(!o||!i.shiftKey)return void(o=this);var n=this,r=0;e(t+":visible").each(function(){switch(r){case 2:return!1;case 1:e(this).prop("checked",o.checked)}this!==n&&this!==o||r++})})})},subtitles_missed:function(){function t(e,t,o,i,n,r){r=r?" checked":"";var a="";return a+=' <tr class="good show-'+e+'">',a+='  <td align="center"><input type="checkbox" class="'+e+'-epcheck" name="'+e+"-"+t+"x"+o+'"'+r+"></td>",a+='  <td style="width: 1%;">'+t+"x"+o+"</td>",a+="  <td>"+i+"</td>",a+=" </tr>"}e(".allCheck").click(function(){var t=e(this).attr("id").split("-")[1];e("."+t+"-epcheck").prop("checked",e(this).prop("checked"))}),e(".get_more_eps").click(function(){var o=e(this).attr("id"),i=e("#allCheck-"+o).prop("checked"),n=e("tr#"+o),r=e(this).attr("data-clicked"),a=e(this).attr("value");r?"Collapse"===a?(e("table tr").filter(".show-"+o).hide(),e(this).prop("value","Expand")):"Expand"===a&&(e("table tr").filter(".show-"+o).show(),e(this).prop("value","Collapse")):(e.getJSON("/manage/showSubtitleMissed",{indexer_id:o,whichSubs:e("#selectSubLang").val()},function(r){e.each(r,function(r,a){e.each(a,function(e,a){n.after(t(o,r,e,a.name,a.subtitles,i))})})}),e(this).attr("data-clicked",1),e(this).prop("value","Collapse"))}),e(".selectAllShows").click(function(){e(".allCheck").each(function(){e(this).prop("checked",!0)}),e('input[class*="-epcheck"]').each(function(){e(this).prop("checked",!0)})}),e(".unselectAllShows").click(function(){e(".allCheck").each(function(){e(this).prop("checked",!1)}),e('input[class*="-epcheck"]').each(function(){e(this).prop("checked",!1)})})}},logs:{init:function(){},view:function(){e("#minLevel,#logFilter,#logSearch").on("keyup change",_.debounce(function(){e("#logSearch").val().length>0&&(e('#logFilter option[value="<NONE>"]').prop("selected",!0),e("#minLevel option[value=5]").prop("selected",!0)),e("#minLevel").prop("disabled",!0),e("#logFilter").prop("disabled",!0),document.body.style.cursor="wait";var t="/logs/viewlog/?minLevel="+e("select[name=minLevel]").val()+"&logFilter="+e("select[name=logFilter]").val()+"&logSearch="+e("#logSearch").val();e.get(t,function(o){history.pushState("data","",t),e("pre").html(e(o).find("pre").html()),e("#minLevel").prop("disabled",!1),e("#logFilter").prop("disabled",!1),document.body.style.cursor="default"})},500))}}};({init:function(){var e=document.body,t=e.getAttribute("data-controller"),o=e.getAttribute("data-action");this.exec("common"),this.exec(t),this.exec(t,o)},exec:function(e,o){o=void 0===o?"init":o,""!==e&&t[e]&&t[e][o]&&{object:t[e][o].init,function:t[e][o]}[typeof t[e][o]]()}}).init()});
